/*!
 *
 *
 * - Neil Carpenter V1
 * - work.js
 * - author: Neil Carpenter (@neilcarpenter)
 * - for development code, remove '.min' from URL
 *
 *
 */var i;(function(e){Function.prototype.bind||(Function.prototype.bind=function(e){var t=[].slice,n=t.call(arguments,1),r=this,i=function(){},s=function(){return r.apply(this instanceof i?this:e||{},n.concat(t.call(arguments)))};i.prototype=r.prototype;s.prototype=new i;return s});typeof e.Code=="undefined"&&(e.Code={});e.Code.Util={registerNamespace:function(){var t=arguments,n=null,r,i,s,o,u;r=0;for(o=t.length;r<o;r++){s=t[r];s=s.split(".");n=s[0];typeof e[n]=="undefined"&&(e[n]={});n=e[n];i=1;for(u=s.length;i<u;++i)n[s[i]]=n[s[i]]||{},n=n[s[i]]}},coalesce:function(){var e,t;e=0;for(t=arguments.length;e<t;e++)if(!this.isNothing(arguments[e]))return arguments[e];return null},extend:function(e,t,n){var r;this.isNothing(n)&&(n=!0);if(e&&t&&this.isObject(t))for(r in t)this.objectHasProperty(t,r)&&(n?e[r]=t[r]:typeof e[r]=="undefined"&&(e[r]=t[r]))},clone:function(e){var t={};this.extend(t,e);return t},isObject:function(e){return e instanceof Object},isFunction:function(e){return{}.toString.call(e)==="[object Function]"},isArray:function(e){return e instanceof Array},isLikeArray:function(e){return typeof e.length=="number"},isNumber:function(e){return typeof e=="number"},isString:function(e){return typeof e=="string"},isNothing:function(e){return typeof e=="undefined"||e===null?!0:!1},swapArrayElements:function(e,t,n){var r=e[t];e[t]=e[n];e[n]=r},trim:function(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},toCamelCase:function(e){return e.replace(/(\-[a-z])/g,function(e){return e.toUpperCase().replace("-","")})},toDashedCase:function(e){return e.replace(/([A-Z])/g,function(e){return"-"+e.toLowerCase()})},arrayIndexOf:function(e,t,n){var r,i,s,o;s=-1;r=0;for(i=t.length;r<i;r++)if(o=t[r],this.isNothing(n)){if(o===e){s=r;break}}else if(this.objectHasProperty(o,n)&&o[n]===e){s=r;break}return s},objectHasProperty:function(e,t){return e.hasOwnProperty?e.hasOwnProperty(t):"undefined"!=typeof e[t]}}})(window);(function(e,t){t.Browser={ua:null,version:null,safari:null,webkit:null,opera:null,msie:null,chrome:null,mozilla:null,android:null,blackberry:null,iPad:null,iPhone:null,iPod:null,iOS:null,is3dSupported:null,isCSSTransformSupported:null,isTouchSupported:null,isGestureSupported:null,_detect:function(){this.ua=e.navigator.userAgent;this.version=this.ua.match(/.+(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[];this.safari=/Safari/gi.test(e.navigator.appVersion);this.webkit=/webkit/i.test(this.ua);this.opera=/opera/i.test(this.ua);this.msie=/msie/i.test(this.ua)&&!this.opera;this.chrome=/Chrome/i.test(this.ua);this.firefox=/Firefox/i.test(this.ua);this.fennec=/Fennec/i.test(this.ua);this.mozilla=/mozilla/i.test(this.ua)&&!/(compatible|webkit)/.test(this.ua);this.android=/android/i.test(this.ua);this.blackberry=/blackberry/i.test(this.ua);this.iOS=/iphone|ipod|ipad/gi.test(e.navigator.platform);this.iPad=/ipad/gi.test(e.navigator.platform);this.iPhone=/iphone/gi.test(e.navigator.platform);this.iPod=/ipod/gi.test(e.navigator.platform);var n=document.createElement("div");this.is3dSupported=!t.isNothing(n.style.WebkitPerspective);this.isCSSTransformSupported=!t.isNothing(n.style.WebkitTransform)||!t.isNothing(n.style.MozTransform)||!t.isNothing(n.style.transformProperty);this.isTouchSupported=this.isEventSupported("touchstart");this.isGestureSupported=this.isEventSupported("gesturestart")},_eventTagNames:{select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"},isEventSupported:function(e){var n=document.createElement(this._eventTagNames[e]||"div"),r,e="on"+e;r=t.objectHasProperty(n,e);r||(n.setAttribute(e,"return;"),r=typeof n[e]=="function");return r},isLandscape:function(){return t.DOM.windowWidth()>t.DOM.windowHeight()}};t.Browser._detect()})(window,window.Code.Util);(function(e,t){t.extend(t,{Events:{add:function(e,t,n){this._checkHandlersProperty(e);t==="mousewheel"&&(t=this._normaliseMouseWheelType());typeof e.__eventHandlers[t]=="undefined"&&(e.__eventHandlers[t]=[]);e.__eventHandlers[t].push(n);this._isBrowserObject(e)&&e.addEventListener(t,n,!1)},remove:function(e,n,r){this._checkHandlersProperty(e);n==="mousewheel"&&(n=this._normaliseMouseWheelType());if(e.__eventHandlers[n]instanceof Array){var i,s,o=e.__eventHandlers[n];if(t.isNothing(r)){if(this._isBrowserObject(e)){i=0;for(s=o.length;i<s;i++)e.removeEventListener(n,o[i],!1)}e.__eventHandlers[n]=[]}else{i=0;for(s=o.length;i<s;i++)if(o[i]===r){o.splice(i,1);break}this._isBrowserObject(e)&&e.removeEventListener(n,r,!1)}}},fire:function(n,r){var i,s,o,u,a=Array.prototype.slice.call(arguments).splice(2);r==="mousewheel"&&(r=this._normaliseMouseWheelType());if(this._isBrowserObject(n)){if(typeof r!="string")throw"type must be a string for DOM elements";o=this._NATIVE_EVENTS[r];i=document.createEvent(o?"HTMLEvents":"UIEvents");i[o?"initEvent":"initUIEvent"](r,!0,!0,e,1);if(a.length<1){n.dispatchEvent(i);return}}this._checkHandlersProperty(n);i=typeof r=="string"?{type:r}:r;i.target||(i.target=n);if(!i.type)throw Error("Event object missing 'type' property.");if(n.__eventHandlers[i.type]instanceof Array){o=n.__eventHandlers[i.type];a.unshift(i);i=0;for(s=o.length;i<s;i++)u=o[i],t.isNothing(u)||u.apply(n,a)}},getMousePosition:function(e){var t={x:0,y:0};e.pageX?t.x=e.pageX:e.clientX&&(t.x=e.clientX+(document.documentElement.scrollLeft||document.body.scrollLeft));e.pageY?t.y=e.pageY:e.clientY&&(t.y=e.clientY+(document.documentElement.scrollTop||document.body.scrollTop));return t},getTouchEvent:function(e){return e},getWheelDelta:function(e){var n=0;t.isNothing(e.wheelDelta)?t.isNothing(e.detail)||(n=-e.detail/3):n=e.wheelDelta/120;return n},domReady:function(e){document.addEventListener("DOMContentLoaded",e,!1)},_checkHandlersProperty:function(e){t.isNothing(e.__eventHandlers)&&t.extend(e,{__eventHandlers:{}})},_isBrowserObject:function(t){return t===e||t===e.document?!0:this._isElement(t)||this._isNode(t)},_isElement:function(t){return typeof e.HTMLElement=="object"?t instanceof e.HTMLElement:typeof t=="object"&&t.nodeType===1&&typeof t.nodeName=="string"},_isNode:function(t){return typeof e.Node=="object"?t instanceof e.Node:typeof t=="object"&&typeof t.nodeType=="number"&&typeof t.nodeName=="string"},_normaliseMouseWheelType:function(){return t.Browser.isEventSupported("mousewheel")?"mousewheel":"DOMMouseScroll"},_NATIVE_EVENTS:{click:1,dblclick:1,mouseup:1,mousedown:1,contextmenu:1,mousewheel:1,DOMMouseScroll:1,mouseover:1,mouseout:1,mousemove:1,selectstart:1,selectend:1,keydown:1,keypress:1,keyup:1,orientationchange:1,touchstart:1,touchmove:1,touchend:1,touchcancel:1,gesturestart:1,gesturechange:1,gestureend:1,focus:1,blur:1,change:1,reset:1,select:1,submit:1,load:1,unload:1,beforeunload:1,resize:1,move:1,DOMContentLoaded:1,readystatechange:1,error:1,abort:1,scroll:1}}})})(window,window.Code.Util);(function(e,t){t.extend(t,{DOM:{setData:function(e,n,r){if(t.isLikeArray(e)){var i,s;i=0;for(s=e.length;i<s;i++)t.DOM._setData(e[i],n,r)}else t.DOM._setData(e,n,r)},_setData:function(e,n,r){t.DOM.setAttribute(e,"data-"+n,r)},getData:function(e,n,r){return t.DOM.getAttribute(e,"data-"+n,r)},removeData:function(e,n){if(t.isLikeArray(e)){var r,i;r=0;for(i=e.length;r<i;r++)t.DOM._removeData(e[r],n)}else t.DOM._removeData(e,n)},_removeData:function(e,n){t.DOM.removeAttribute(e,"data-"+n)},isChildOf:function(e,t){if(t===e)return!1;for(;e&&e!==t;)e=e.parentNode;return e===t},find:function(n,r){t.isNothing(r)&&(r=e.document);var i=r.querySelectorAll(n),s=[],o,u;o=0;for(u=i.length;o<u;o++)s.push(i[o]);return s},createElement:function(e,n,r){var i,e=document.createElement(e);for(i in n)t.objectHasProperty(n,i)&&e.setAttribute(i,n[i]);e.innerHTML=r||"";return e},appendChild:function(e,t){t.appendChild(e)},insertBefore:function(e,t,n){n.insertBefore(e,t)},appendText:function(e,n){t.DOM.appendChild(document.createTextNode(e),n)},appendToBody:function(e){this.appendChild(e,document.body)},removeChild:function(e,t){t.removeChild(e)},removeChildren:function(e){if(e.hasChildNodes())for(;e.childNodes.length>=1;)e.removeChild(e.childNodes[e.childNodes.length-1])},hasAttribute:function(e,n){return!t.isNothing(e.getAttribute(n))},getAttribute:function(e,n,r){e=e.getAttribute(n);t.isNothing(e)&&!t.isNothing(r)&&(e=r);return e},setAttribute:function(e,n,r){if(t.isLikeArray(e)){var i,s;i=0;for(s=e.length;i<s;i++)t.DOM._setAttribute(e[i],n,r)}else t.DOM._setAttribute(e,n,r)},_setAttribute:function(e,t,n){e.setAttribute(t,n)},removeAttribute:function(e,n){if(t.isLikeArray(e)){var r,i;r=0;for(i=e.length;r<i;r++)t.DOM._removeAttribute(e[r],n)}else t.DOM._removeAttribute(e,n)},_removeAttribute:function(e,t){this.hasAttribute(e,t)&&e.removeAttribute(t)},addClass:function(e,n){if(t.isLikeArray(e)){var r,i;r=0;for(i=e.length;r<i;r++)t.DOM._addClass(e[r],n)}else t.DOM._addClass(e,n)},_addClass:function(e,n){var r=t.DOM.getAttribute(e,"class","");RegExp("(?:^|\\s+)"+n+"(?:\\s+|$)").test(r)||(r!==""&&(r+=" "),r+=n,t.DOM.setAttribute(e,"class",r))},removeClass:function(e,n){if(t.isLikeArray(e)){var r,i;r=0;for(i=e.length;r<i;r++)t.DOM._removeClass(e[r],n)}else t.DOM._removeClass(e,n)},_removeClass:function(e,n){var r=t.DOM.getAttribute(e,"class",""),r=t.trim(r).split(" "),i="",s,o;s=0;for(o=r.length;s<o;s++)r[s]!==n&&(i!==""&&(i+=" "),i+=r[s]);i===""?t.DOM.removeAttribute(e,"class"):t.DOM.setAttribute(e,"class",i)},hasClass:function(e,n){return RegExp("(?:^|\\s+)"+n+"(?:\\s+|$)").test(t.DOM.getAttribute(e,"class",""))},setStyle:function(e,n,r){if(t.isLikeArray(e)){var i,s;i=0;for(s=e.length;i<s;i++)t.DOM._setStyle(e[i],n,r)}else t.DOM._setStyle(e,n,r)},_setStyle:function(e,n,r){var i;if(t.isObject(n))for(i in n)t.objectHasProperty(n,i)&&(i==="width"?t.DOM.width(e,n[i]):i==="height"?t.DOM.height(e,n[i]):e.style[i]=n[i]);else e.style[n]=r},getStyle:function(t,n){var r=e.getComputedStyle(t,"").getPropertyValue(n);r===""&&(r=t.style[n]);return r},hide:function(e){if(t.isLikeArray(e)){var n,r;n=0;for(r=e.length;n<r;n++)t.DOM._hide(e[n])}else t.DOM._hide(e)},_hide:function(e){t.DOM.setData(e,"ccl-disp",t.DOM.getStyle(e,"display"));t.DOM.setStyle(e,"display","none")},show:function(e){if(t.isLikeArray(e)){var n,r;n=0;for(r=e.length;n<r;n++)t.DOM._show(e[n])}else t.DOM._show(e)},_show:function(e){if(t.DOM.getStyle(e,"display")==="none"){var n=t.DOM.getData(e,"ccl-disp","block");if(n==="none"||n==="")n="block";t.DOM.setStyle(e,"display",n)}},width:function(e,n){t.isNothing(n)||(t.isNumber(n)&&(n+="px"),e.style.width=n);return this._getDimension(e,"width")},outerWidth:function(e){var n=t.DOM.width(e);n+=parseInt(t.DOM.getStyle(e,"padding-left"),10)+parseInt(t.DOM.getStyle(e,"padding-right"),10);n+=parseInt(t.DOM.getStyle(e,"margin-left"),10)+parseInt(t.DOM.getStyle(e,"margin-right"),10);n+=parseInt(t.DOM.getStyle(e,"border-left-width"),10)+parseInt(t.DOM.getStyle(e,"border-right-width"),10);return n},height:function(e,n){t.isNothing(n)||(t.isNumber(n)&&(n+="px"),e.style.height=n);return this._getDimension(e,"height")},_getDimension:function(t,n){var r=e.parseInt(e.getComputedStyle(t,"").getPropertyValue(n)),i;isNaN(r)&&(i={display:t.style.display,left:t.style.left},t.style.display="block",t.style.left="-1000000px",r=e.parseInt(e.getComputedStyle(t,"").getPropertyValue(n)),t.style.display=i.display,t.style.left=i.left);return r},outerHeight:function(e){var n=t.DOM.height(e);n+=parseInt(t.DOM.getStyle(e,"padding-top"),10)+parseInt(t.DOM.getStyle(e,"padding-bottom"),10);n+=parseInt(t.DOM.getStyle(e,"margin-top"),10)+parseInt(t.DOM.getStyle(e,"margin-bottom"),10);n+=parseInt(t.DOM.getStyle(e,"border-top-width"),10)+parseInt(t.DOM.getStyle(e,"border-bottom-width"),10);return n},documentWidth:function(){return t.DOM.width(document.documentElement)},documentHeight:function(){return t.DOM.height(document.documentElement)},documentOuterWidth:function(){return t.DOM.width(document.documentElement)},documentOuterHeight:function(){return t.DOM.outerHeight(document.documentElement)},bodyWidth:function(){return t.DOM.width(document.body)},bodyHeight:function(){return t.DOM.height(document.body)},bodyOuterWidth:function(){return t.DOM.outerWidth(document.body)},bodyOuterHeight:function(){return t.DOM.outerHeight(document.body)},windowWidth:function(){return e.innerWidth},windowHeight:function(){return e.innerHeight},windowScrollLeft:function(){return e.pageXOffset},windowScrollTop:function(){return e.pageYOffset}}})})(window,window.Code.Util);(function(e,t){t.extend(t,{Animation:{_applyTransitionDelay:50,_transitionEndLabel:e.document.documentElement.style.webkitTransition!==void 0?"webkitTransitionEnd":"transitionend",_transitionEndHandler:null,_transitionPrefix:e.document.documentElement.style.webkitTransition!==void 0?"webkitTransition":e.document.documentElement.style.MozTransition!==void 0?"MozTransition":"transition",_transformLabel:e.document.documentElement.style.webkitTransform!==void 0?"webkitTransform":e.document.documentElement.style.MozTransition!==void 0?"MozTransform":"transform",_getTransitionEndHandler:function(){t.isNothing(this._transitionEndHandler)&&(this._transitionEndHandler=this._onTransitionEnd.bind(this));return this._transitionEndHandler},stop:function(n){if(t.Browser.isCSSTransformSupported){var r={};t.Events.remove(n,this._transitionEndLabel,this._getTransitionEndHandler());t.isNothing(n.callbackLabel)&&delete n.callbackLabel;r[this._transitionPrefix+"Property"]="";r[this._transitionPrefix+"Duration"]="";r[this._transitionPrefix+"TimingFunction"]="";r[this._transitionPrefix+"Delay"]="";r[this._transformLabel]="";t.DOM.setStyle(n,r)}else t.isNothing(e.jQuery)||e.jQuery(n).stop(!0,!0)},fadeIn:function(n,r,i,s,o){o=t.coalesce(o,1);o<=0&&(o=1);if(r<=0&&(t.DOM.setStyle(n,"opacity",o),!t.isNothing(i))){i(n);return}t.DOM.getStyle(n,"opacity")>=1&&t.DOM.setStyle(n,"opacity",0);t.Browser.isCSSTransformSupported?this._applyTransition(n,"opacity",o,r,i,s):t.isNothing(e.jQuery)||e.jQuery(n).fadeTo(r,o,i)},fadeTo:function(e,t,n,r,i){this.fadeIn(e,n,r,i,t)},fadeOut:function(n,r,i,s){if(r<=0&&(t.DOM.setStyle(n,"opacity",0),!t.isNothing(i))){i(n);return}t.Browser.isCSSTransformSupported?this._applyTransition(n,"opacity",0,r,i,s):e.jQuery(n).fadeTo(r,0,i)},slideBy:function(n,r,i,s,o,u){var a={},r=t.coalesce(r,0),i=t.coalesce(i,0),u=t.coalesce(u,"ease-out");a[this._transitionPrefix+"Property"]="all";a[this._transitionPrefix+"Delay"]="0";s===0?(a[this._transitionPrefix+"Duration"]="",a[this._transitionPrefix+"TimingFunction"]=""):(a[this._transitionPrefix+"Duration"]=s+"ms",a[this._transitionPrefix+"TimingFunction"]=t.coalesce(u,"ease-out"),t.Events.add(n,this._transitionEndLabel,this._getTransitionEndHandler()));a[this._transformLabel]=t.Browser.is3dSupported?"translate3d("+r+"px, "+i+"px, 0px)":"translate("+r+"px, "+i+"px)";t.isNothing(o)||(n.cclallcallback=o);t.DOM.setStyle(n,a);s===0&&e.setTimeout(function(){this._leaveTransforms(n)}.bind(this),this._applyTransitionDelay)},resetTranslate:function(e){var n={};n[this._transformLabel]=n[this._transformLabel]=t.Browser.is3dSupported?"translate3d(0px, 0px, 0px)":"translate(0px, 0px)";t.DOM.setStyle(e,n)},_applyTransition:function(n,r,i,s,o,u){var a={},u=t.coalesce(u,"ease-in");a[this._transitionPrefix+"Property"]=r;a[this._transitionPrefix+"Duration"]=s+"ms";a[this._transitionPrefix+"TimingFunction"]=u;a[this._transitionPrefix+"Delay"]="0";t.Events.add(n,this._transitionEndLabel,this._getTransitionEndHandler());t.DOM.setStyle(n,a);t.isNothing(o)||(n["ccl"+r+"callback"]=o);e.setTimeout(function(){t.DOM.setStyle(n,r,i)},this._applyTransitionDelay)},_onTransitionEnd:function(e){t.Events.remove(e.currentTarget,this._transitionEndLabel,this._getTransitionEndHandler());this._leaveTransforms(e.currentTarget)},_leaveTransforms:function(n){var r=n.style[this._transitionPrefix+"Property"],i=r!==""?"ccl"+r+"callback":"cclallcallback",s,r=t.coalesce(n.style.webkitTransform,n.style.MozTransform,n.style.transform),o,u=e.parseInt(t.DOM.getStyle(n,"left"),0),a=e.parseInt(t.DOM.getStyle(n,"top"),0),f,l,h={};r!==""&&(r=t.Browser.is3dSupported?r.match(/translate3d\((.*?)\)/):r.match(/translate\((.*?)\)/),t.isNothing(r)||(o=r[1].split(", "),f=e.parseInt(o[0],0),l=e.parseInt(o[1],0)));h[this._transitionPrefix+"Property"]="";h[this._transitionPrefix+"Duration"]="";h[this._transitionPrefix+"TimingFunction"]="";h[this._transitionPrefix+"Delay"]="";t.DOM.setStyle(n,h);e.setTimeout(function(){t.isNothing(o)||(h={},h[this._transformLabel]="",h.left=u+f+"px",h.top=a+l+"px",t.DOM.setStyle(n,h));t.isNothing(n[i])||(s=n[i],delete n[i],s(n))}.bind(this),this._applyTransitionDelay)}}})})(window,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.Util.TouchElement");n.TouchElement.EventTypes={onTouch:"CodeUtilTouchElementOnTouch"};n.TouchElement.ActionTypes={touchStart:"touchStart",touchMove:"touchMove",touchEnd:"touchEnd",touchMoveEnd:"touchMoveEnd",tap:"tap",doubleTap:"doubleTap",swipeLeft:"swipeLeft",swipeRight:"swipeRight",swipeUp:"swipeUp",swipeDown:"swipeDown",gestureStart:"gestureStart",gestureChange:"gestureChange",gestureEnd:"gestureEnd"}})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.Util.TouchElement");n.TouchElement.TouchElementClass=t({el:null,captureSettings:null,touchStartPoint:null,touchEndPoint:null,touchStartTime:null,doubleTapTimeout:null,touchStartHandler:null,touchMoveHandler:null,touchEndHandler:null,mouseDownHandler:null,mouseMoveHandler:null,mouseUpHandler:null,mouseOutHandler:null,gestureStartHandler:null,gestureChangeHandler:null,gestureEndHandler:null,swipeThreshold:null,swipeTimeThreshold:null,doubleTapSpeed:null,dispose:function(){var e;this.removeEventHandlers();for(e in this)n.objectHasProperty(this,e)&&(this[e]=null)},initialize:function(e,t){this.el=e;this.captureSettings={swipe:!1,move:!1,gesture:!1,doubleTap:!1,preventDefaultTouchEvents:!0};n.extend(this.captureSettings,t);this.swipeThreshold=50;this.doubleTapSpeed=this.swipeTimeThreshold=250;this.touchStartPoint={x:0,y:0};this.touchEndPoint={x:0,y:0}},addEventHandlers:function(){n.isNothing(this.touchStartHandler)&&(this.touchStartHandler=this.onTouchStart.bind(this),this.touchMoveHandler=this.onTouchMove.bind(this),this.touchEndHandler=this.onTouchEnd.bind(this),this.mouseDownHandler=this.onMouseDown.bind(this),this.mouseMoveHandler=this.onMouseMove.bind(this),this.mouseUpHandler=this.onMouseUp.bind(this),this.mouseOutHandler=this.onMouseOut.bind(this),this.gestureStartHandler=this.onGestureStart.bind(this),this.gestureChangeHandler=this.onGestureChange.bind(this),this.gestureEndHandler=this.onGestureEnd.bind(this));n.Events.add(this.el,"touchstart",this.touchStartHandler);this.captureSettings.move&&n.Events.add(this.el,"touchmove",this.touchMoveHandler);n.Events.add(this.el,"touchend",this.touchEndHandler);n.Events.add(this.el,"mousedown",this.mouseDownHandler);n.Browser.isGestureSupported&&this.captureSettings.gesture&&(n.Events.add(this.el,"gesturestart",this.gestureStartHandler),n.Events.add(this.el,"gesturechange",this.gestureChangeHandler),n.Events.add(this.el,"gestureend",this.gestureEndHandler))},removeEventHandlers:function(){n.Events.remove(this.el,"touchstart",this.touchStartHandler);this.captureSettings.move&&n.Events.remove(this.el,"touchmove",this.touchMoveHandler);n.Events.remove(this.el,"touchend",this.touchEndHandler);n.Events.remove(this.el,"mousedown",this.mouseDownHandler);n.Browser.isGestureSupported&&this.captureSettings.gesture&&(n.Events.remove(this.el,"gesturestart",this.gestureStartHandler),n.Events.remove(this.el,"gesturechange",this.gestureChangeHandler),n.Events.remove(this.el,"gestureend",this.gestureEndHandler))},getTouchPoint:function(e){return{x:e[0].pageX,y:e[0].pageY}},fireTouchEvent:function(t){var r=0,i=0,s=0,o,r=this.touchEndPoint.x-this.touchStartPoint.x,i=this.touchEndPoint.y-this.touchStartPoint.y,s=Math.sqrt(r*r+i*i);if(this.captureSettings.swipe&&(o=new Date,o-=this.touchStartTime,o<=this.swipeTimeThreshold)){if(e.Math.abs(r)>=this.swipeThreshold){n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:r<0?n.TouchElement.ActionTypes.swipeLeft:n.TouchElement.ActionTypes.swipeRight,targetEl:t.target,currentTargetEl:t.currentTarget});return}if(e.Math.abs(i)>=this.swipeThreshold){n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:i<0?n.TouchElement.ActionTypes.swipeUp:n.TouchElement.ActionTypes.swipeDown,targetEl:t.target,currentTargetEl:t.currentTarget});return}}s>1?n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.touchMoveEnd,point:this.touchEndPoint,targetEl:t.target,currentTargetEl:t.currentTarget}):this.captureSettings.doubleTap?n.isNothing(this.doubleTapTimeout)?this.doubleTapTimeout=e.setTimeout(function(){this.doubleTapTimeout=null;n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:n.TouchElement.ActionTypes.tap,targetEl:t.target,currentTargetEl:t.currentTarget})}.bind(this),this.doubleTapSpeed):(e.clearTimeout(this.doubleTapTimeout),this.doubleTapTimeout=null,n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:n.TouchElement.ActionTypes.doubleTap,targetEl:t.target,currentTargetEl:t.currentTarget})):n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,point:this.touchEndPoint,action:n.TouchElement.ActionTypes.tap,targetEl:t.target,currentTargetEl:t.currentTarget})},onTouchStart:function(e){this.captureSettings.preventDefaultTouchEvents&&e.preventDefault();n.Events.remove(this.el,"mousedown",this.mouseDownHandler);var t=n.Events.getTouchEvent(e).touches;t.length>1&&this.captureSettings.gesture?this.isGesture=!0:(this.touchStartTime=new Date,this.isGesture=!1,this.touchStartPoint=this.getTouchPoint(t),n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.touchStart,point:this.touchStartPoint,targetEl:e.target,currentTargetEl:e.currentTarget}))},onTouchMove:function(e){this.captureSettings.preventDefaultTouchEvents&&e.preventDefault();if(!this.isGesture||!this.captureSettings.gesture){var t=n.Events.getTouchEvent(e).touches;n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.touchMove,point:this.getTouchPoint(t),targetEl:e.target,currentTargetEl:e.currentTarget})}},onTouchEnd:function(e){if(!this.isGesture||!this.captureSettings.gesture){this.captureSettings.preventDefaultTouchEvents&&e.preventDefault();var t=n.Events.getTouchEvent(e);this.touchEndPoint=this.getTouchPoint(n.isNothing(t.changedTouches)?t.touches:t.changedTouches);n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:e.target,currentTargetEl:e.currentTarget});this.fireTouchEvent(e)}},onMouseDown:function(e){e.preventDefault();n.Events.remove(this.el,"touchstart",this.mouseDownHandler);n.Events.remove(this.el,"touchmove",this.touchMoveHandler);n.Events.remove(this.el,"touchend",this.touchEndHandler);this.captureSettings.move&&n.Events.add(this.el,"mousemove",this.mouseMoveHandler);n.Events.add(this.el,"mouseup",this.mouseUpHandler);n.Events.add(this.el,"mouseout",this.mouseOutHandler);this.touchStartTime=new Date;this.isGesture=!1;this.touchStartPoint=n.Events.getMousePosition(e);n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.touchStart,point:this.touchStartPoint,targetEl:e.target,currentTargetEl:e.currentTarget})},onMouseMove:function(e){e.preventDefault();n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.touchMove,point:n.Events.getMousePosition(e),targetEl:e.target,currentTargetEl:e.currentTarget})},onMouseUp:function(e){e.preventDefault();this.captureSettings.move&&n.Events.remove(this.el,"mousemove",this.mouseMoveHandler);n.Events.remove(this.el,"mouseup",this.mouseUpHandler);n.Events.remove(this.el,"mouseout",this.mouseOutHandler);this.touchEndPoint=n.Events.getMousePosition(e);n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:e.target,currentTargetEl:e.currentTarget});this.fireTouchEvent(e)},onMouseOut:function(e){var t=e.relatedTarget;this.el!==t&&!n.DOM.isChildOf(t,this.el)&&(e.preventDefault(),this.captureSettings.move&&n.Events.remove(this.el,"mousemove",this.mouseMoveHandler),n.Events.remove(this.el,"mouseup",this.mouseUpHandler),n.Events.remove(this.el,"mouseout",this.mouseOutHandler),this.touchEndPoint=n.Events.getMousePosition(e),n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.touchEnd,point:this.touchEndPoint,targetEl:e.target,currentTargetEl:e.currentTarget}),this.fireTouchEvent(e))},onGestureStart:function(e){e.preventDefault();var t=n.Events.getTouchEvent(e);n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.gestureStart,scale:t.scale,rotation:t.rotation,targetEl:e.target,currentTargetEl:e.currentTarget})},onGestureChange:function(e){e.preventDefault();var t=n.Events.getTouchEvent(e);n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.gestureChange,scale:t.scale,rotation:t.rotation,targetEl:e.target,currentTargetEl:e.currentTarget})},onGestureEnd:function(e){e.preventDefault();var t=n.Events.getTouchEvent(e);n.Events.fire(this,{type:n.TouchElement.EventTypes.onTouch,target:this,action:n.TouchElement.ActionTypes.gestureEnd,scale:t.scale,rotation:t.rotation,targetEl:e.target,currentTargetEl:e.currentTarget})}})})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.Image");e.Code.PhotoSwipe.Image.EventTypes={onLoad:"onLoad",onError:"onError"}})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.Image");var r=e.Code.PhotoSwipe;r.Image.ImageClass=t({refObj:null,imageEl:null,src:null,caption:null,metaData:null,imageLoadHandler:null,imageErrorHandler:null,dispose:function(){var e;this.shrinkImage();for(e in this)n.objectHasProperty(this,e)&&(this[e]=null)},initialize:function(t,n,r,i){this.refObj=t;this.src=this.originalSrc=n;this.caption=r;this.metaData=i;this.imageEl=new e.Image;this.imageLoadHandler=this.onImageLoad.bind(this);this.imageErrorHandler=this.onImageError.bind(this)},load:function(){this.imageEl.originalSrc=n.coalesce(this.imageEl.originalSrc,"");this.imageEl.originalSrc===this.src?this.imageEl.isError?n.Events.fire(this,{type:r.Image.EventTypes.onError,target:this}):n.Events.fire(this,{type:r.Image.EventTypes.onLoad,target:this}):(this.imageEl.isError=!1,this.imageEl.isLoading=!0,this.imageEl.naturalWidth=null,this.imageEl.naturalHeight=null,this.imageEl.isLandscape=!1,this.imageEl.onload=this.imageLoadHandler,this.imageEl.onerror=this.imageErrorHandler,this.imageEl.onabort=this.imageErrorHandler,this.imageEl.originalSrc=this.src,this.imageEl.src=this.src)},shrinkImage:function(){!n.isNothing(this.imageEl)&&this.imageEl.src.indexOf(this.src)>-1&&(this.imageEl.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",n.isNothing(this.imageEl.parentNode)||n.DOM.removeChild(this.imageEl,this.imageEl.parentNode))},onImageLoad:function(){this.imageEl.onload=null;this.imageEl.naturalWidth=n.coalesce(this.imageEl.naturalWidth,this.imageEl.width);this.imageEl.naturalHeight=n.coalesce(this.imageEl.naturalHeight,this.imageEl.height);this.imageEl.isLandscape=this.imageEl.naturalWidth>this.imageEl.naturalHeight;this.imageEl.isLoading=!1;n.Events.fire(this,{type:r.Image.EventTypes.onLoad,target:this})},onImageError:function(){this.imageEl.onload=null;this.imageEl.onerror=null;this.imageEl.onabort=null;this.imageEl.isLoading=!1;this.imageEl.isError=!0;n.Events.fire(this,{type:r.Image.EventTypes.onError,target:this})}})})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.Cache");e=e.Code.PhotoSwipe;e.Cache.Mode={normal:"normal",aggressive:"aggressive"};e.Cache.Functions={getImageSource:function(e){return e.href},getImageCaption:function(e){if(e.nodeName==="IMG")return n.DOM.getAttribute(e,"alt");var t,r,i;t=0;for(r=e.childNodes.length;t<r;t++)if(i=e.childNodes[t],e.childNodes[t].nodeName==="IMG")return n.DOM.getAttribute(i,"alt")},getImageMetaData:function(){return{}}}})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.Cache");var r=e.Code.PhotoSwipe;r.Cache.CacheClass=t({images:null,settings:null,dispose:function(){var e,t,r;if(!n.isNothing(this.images)){t=0;for(r=this.images.length;t<r;t++)this.images[t].dispose();this.images.length=0}for(e in this)n.objectHasProperty(this,e)&&(this[e]=null)},initialize:function(e,t){var n,i,s,o,u,a;this.settings=t;this.images=[];n=0;for(i=e.length;n<i;n++)s=e[n],o=this.settings.getImageSource(s),u=this.settings.getImageCaption(s),a=this.settings.getImageMetaData(s),this.images.push(new r.Image.ImageClass(s,o,u,a))},getImages:function(e){var t,i,s=[],o;t=0;for(i=e.length;t<i;t++){o=this.images[e[t]];this.settings.cacheMode===r.Cache.Mode.aggressive&&(o.cacheDoNotShrink=!0);s.push(o)}if(this.settings.cacheMode===r.Cache.Mode.aggressive){t=0;for(i=this.images.length;t<i;t++)o=this.images[t],n.objectHasProperty(o,"cacheDoNotShrink")?delete o.cacheDoNotShrink:o.shrinkImage()}return s}})})(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.Image);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.DocumentOverlay");e.Code.PhotoSwipe.DocumentOverlay.CssClasses={documentOverlay:"ps-document-overlay"}})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.DocumentOverlay");var r=e.Code.PhotoSwipe;r.DocumentOverlay.DocumentOverlayClass=t({el:null,settings:null,initialBodyHeight:null,dispose:function(){var e;n.Animation.stop(this.el);n.DOM.removeChild(this.el,this.el.parentNode);for(e in this)n.objectHasProperty(this,e)&&(this[e]=null)},initialize:function(t){this.settings=t;this.el=n.DOM.createElement("div",{"class":r.DocumentOverlay.CssClasses.documentOverlay},"");n.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,zIndex:this.settings.zIndex});n.DOM.hide(this.el);this.settings.target===e?n.DOM.appendToBody(this.el):n.DOM.appendChild(this.el,this.settings.target);n.Animation.resetTranslate(this.el);this.initialBodyHeight=n.DOM.bodyOuterHeight()},resetPosition:function(){var t,r,i;if(this.settings.target===e){t=n.DOM.windowWidth();r=n.DOM.bodyOuterHeight()*2;i=this.settings.jQueryMobile?n.DOM.windowScrollTop()+"px":"0px";r<1&&(r=this.initialBodyHeight);n.DOM.windowHeight()>r&&(r=n.DOM.windowHeight())}else t=n.DOM.width(this.settings.target),r=n.DOM.height(this.settings.target),i="0px";n.DOM.setStyle(this.el,{width:t,height:r,top:i})},fadeIn:function(e,t){this.resetPosition();n.DOM.setStyle(this.el,"opacity",0);n.DOM.show(this.el);n.Animation.fadeIn(this.el,e,t)}})})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.Carousel");e=e.Code.PhotoSwipe;e.Carousel.EventTypes={onSlideByEnd:"PhotoSwipeCarouselOnSlideByEnd",onSlideshowStart:"PhotoSwipeCarouselOnSlideshowStart",onSlideshowStop:"PhotoSwipeCarouselOnSlideshowStop"};e.Carousel.CssClasses={carousel:"ps-carousel",content:"ps-carousel-content",item:"ps-carousel-item",itemLoading:"ps-carousel-item-loading",itemError:"ps-carousel-item-error"};e.Carousel.SlideByAction={previous:"previous",current:"current",next:"next"}})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.Carousel");var r=e.Code.PhotoSwipe;r.Carousel.CarouselClass=t({el:null,contentEl:null,settings:null,cache:null,slideByEndHandler:null,currentCacheIndex:null,isSliding:null,isSlideshowActive:null,lastSlideByAction:null,touchStartPoint:null,touchStartPosition:null,imageLoadHandler:null,imageErrorHandler:null,slideshowTimeout:null,dispose:function(){var e,t,i;t=0;for(i=this.cache.images.length;t<i;t++)n.Events.remove(this.cache.images[t],r.Image.EventTypes.onLoad,this.imageLoadHandler),n.Events.remove(this.cache.images[t],r.Image.EventTypes.onError,this.imageErrorHandler);this.stopSlideshow();n.Animation.stop(this.el);n.DOM.removeChild(this.el,this.el.parentNode);for(e in this)n.objectHasProperty(this,e)&&(this[e]=null)},initialize:function(t,i){var s,o,u;this.cache=t;this.settings=i;this.slideByEndHandler=this.onSlideByEnd.bind(this);this.imageLoadHandler=this.onImageLoad.bind(this);this.imageErrorHandler=this.onImageError
.bind(this);this.currentCacheIndex=0;this.isSlideshowActive=this.isSliding=!1;this.cache.images.length<3&&(this.settings.loop=!1);this.el=n.DOM.createElement("div",{"class":r.Carousel.CssClasses.carousel},"");n.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,overflow:"hidden",zIndex:this.settings.zIndex});n.DOM.hide(this.el);this.contentEl=n.DOM.createElement("div",{"class":r.Carousel.CssClasses.content},"");n.DOM.setStyle(this.contentEl,{display:"block",position:"absolute",left:0,top:0});n.DOM.appendChild(this.contentEl,this.el);o=t.images.length<3?t.images.length:3;for(s=0;s<o;s++)u=n.DOM.createElement("div",{"class":r.Carousel.CssClasses.item+" "+r.Carousel.CssClasses.item+"-"+s},""),n.DOM.setAttribute(u,"style","float: left;"),n.DOM.setStyle(u,{display:"block",position:"relative",left:0,top:0,overflow:"hidden"}),this.settings.margin>0&&n.DOM.setStyle(u,{marginRight:this.settings.margin+"px"}),n.DOM.appendChild(u,this.contentEl);this.settings.target===e?n.DOM.appendToBody(this.el):n.DOM.appendChild(this.el,this.settings.target)},resetPosition:function(){var t,i,s,o,u,f;this.settings.target===e?(t=n.DOM.windowWidth(),i=n.DOM.windowHeight(),s=n.DOM.windowScrollTop()+"px"):(t=n.DOM.width(this.settings.target),i=n.DOM.height(this.settings.target),s="0px");o=this.settings.margin>0?t+this.settings.margin:t;u=n.DOM.find("."+r.Carousel.CssClasses.item,this.contentEl);o*=u.length;n.DOM.setStyle(this.el,{top:s,width:t,height:i});n.DOM.setStyle(this.contentEl,{width:o,height:i});s=0;for(o=u.length;s<o;s++)f=u[s],n.DOM.setStyle(f,{width:t,height:i}),f=n.DOM.find("img",f)[0],n.isNothing(f)||this.resetImagePosition(f);this.setContentLeftPosition()},resetImagePosition:function(e){if(!n.isNothing(e)){n.DOM.getAttribute(e,"src");var t,r,i,s=n.DOM.width(this.el),o=n.DOM.height(this.el);this.settings.imageScaleMethod==="fitNoUpscale"?(r=e.naturalWidth,i=e.naturalHeight,r>s&&(t=s/r,r=Math.round(r*t),i=Math.round(i*t)),i>o&&(t=o/i,i=Math.round(i*t),r=Math.round(r*t))):(t=e.isLandscape?s/e.naturalWidth:o/e.naturalHeight,r=Math.round(e.naturalWidth*t),i=Math.round(e.naturalHeight*t),this.settings.imageScaleMethod==="zoom"?(t=1,i<o?t=o/i:r<s&&(t=s/r),t!==1&&(r=Math.round(r*t),i=Math.round(i*t))):this.settings.imageScaleMethod==="fit"&&(t=1,r>s?t=s/r:i>o&&(t=o/i),t!==1&&(r=Math.round(r*t),i=Math.round(i*t))));n.DOM.setStyle(e,{position:"absolute",width:r,height:i,top:Math.round((o-i)/2)+"px",left:Math.round((s-r)/2)+"px",display:"block"})}},setContentLeftPosition:function(){var t,r,i;t=this.settings.target===e?n.DOM.windowWidth():n.DOM.width(this.settings.target);r=this.getItemEls();i=0;this.settings.loop?i=(t+this.settings.margin)*-1:this.currentCacheIndex===this.cache.images.length-1?i=(r.length-1)*(t+this.settings.margin)*-1:this.currentCacheIndex>0&&(i=(t+this.settings.margin)*-1);n.DOM.setStyle(this.contentEl,{left:i+"px"})},show:function(e){this.currentCacheIndex=e;this.resetPosition();this.setImages(!1);n.DOM.show(this.el);n.Animation.resetTranslate(this.contentEl);var e=this.getItemEls(),t,i;t=0;for(i=e.length;t<i;t++)n.Animation.resetTranslate(e[t]);n.Events.fire(this,{type:r.Carousel.EventTypes.onSlideByEnd,target:this,action:r.Carousel.SlideByAction.current,cacheIndex:this.currentCacheIndex})},setImages:function(e){var t,n=this.getItemEls();t=this.currentCacheIndex+1;var r=this.currentCacheIndex-1;this.settings.loop?(t>this.cache.images.length-1&&(t=0),r<0&&(r=this.cache.images.length-1),t=this.cache.getImages([r,this.currentCacheIndex,t]),e||this.addCacheImageToItemEl(t[1],n[1]),this.addCacheImageToItemEl(t[2],n[2]),this.addCacheImageToItemEl(t[0],n[0])):n.length===1?e||(t=this.cache.getImages([this.currentCacheIndex]),this.addCacheImageToItemEl(t[0],n[0])):n.length===2?this.currentCacheIndex===0?(t=this.cache.getImages([this.currentCacheIndex,this.currentCacheIndex+1]),e||this.addCacheImageToItemEl(t[0],n[0]),this.addCacheImageToItemEl(t[1],n[1])):(t=this.cache.getImages([this.currentCacheIndex-1,this.currentCacheIndex]),e||this.addCacheImageToItemEl(t[1],n[1]),this.addCacheImageToItemEl(t[0],n[0])):this.currentCacheIndex===0?(t=this.cache.getImages([this.currentCacheIndex,this.currentCacheIndex+1,this.currentCacheIndex+2]),e||this.addCacheImageToItemEl(t[0],n[0]),this.addCacheImageToItemEl(t[1],n[1]),this.addCacheImageToItemEl(t[2],n[2])):(this.currentCacheIndex===this.cache.images.length-1?(t=this.cache.getImages([this.currentCacheIndex-2,this.currentCacheIndex-1,this.currentCacheIndex]),e||this.addCacheImageToItemEl(t[2],n[2]),this.addCacheImageToItemEl(t[1],n[1])):(t=this.cache.getImages([this.currentCacheIndex-1,this.currentCacheIndex,this.currentCacheIndex+1]),e||this.addCacheImageToItemEl(t[1],n[1]),this.addCacheImageToItemEl(t[2],n[2])),this.addCacheImageToItemEl(t[0],n[0]))},addCacheImageToItemEl:function(e,t){n.DOM.removeClass(t,r.Carousel.CssClasses.itemError);n.DOM.addClass(t,r.Carousel.CssClasses.itemLoading);n.DOM.removeChildren(t);n.DOM.setStyle(e.imageEl,{display:"none"});n.DOM.appendChild(e.imageEl,t);n.Animation.resetTranslate(e.imageEl);n.Events.add(e,r.Image.EventTypes.onLoad,this.imageLoadHandler);n.Events.add(e,r.Image.EventTypes.onError,this.imageErrorHandler);e.load()},slideCarousel:function(t,i,s){if(!this.isSliding){var o,u;o=this.settings.target===e?n.DOM.windowWidth()+this.settings.margin:n.DOM.width(this.settings.target)+this.settings.margin;s=n.coalesce(s,this.settings.slideSpeed);if(!(e.Math.abs(u)<1)){switch(i){case n.TouchElement.ActionTypes.swipeLeft:t=o*-1;break;case n.TouchElement.ActionTypes.swipeRight:t=o;break;default:u=t.x-this.touchStartPoint.x,t=e.Math.abs(u)>o/2?u>0?o:o*-1:0}this.lastSlideByAction=t<0?r.Carousel.SlideByAction.next:t>0?r.Carousel.SlideByAction.previous:r.Carousel.SlideByAction.current;!this.settings.loop&&(this.lastSlideByAction===r.Carousel.SlideByAction.previous&&this.currentCacheIndex===0||this.lastSlideByAction===r.Carousel.SlideByAction.next&&this.currentCacheIndex===this.cache.images.length-1)&&(t=0,this.lastSlideByAction=r.Carousel.SlideByAction.current);this.isSliding=!0;this.doSlideCarousel(t,s)}}},moveCarousel:function(e){this.isSliding||this.settings.enableDrag&&this.doMoveCarousel(e.x-this.touchStartPoint.x)},getItemEls:function(){return n.DOM.find("."+r.Carousel.CssClasses.item,this.contentEl)},previous:function(){this.stopSlideshow();this.slideCarousel({x:0,y:0},n.TouchElement.ActionTypes.swipeRight,this.settings.nextPreviousSlideSpeed)},next:function(){this.stopSlideshow();this.slideCarousel({x:0,y:0},n.TouchElement.ActionTypes.swipeLeft,this.settings.nextPreviousSlideSpeed)},slideshowNext:function(){this.slideCarousel({x:0,y:0},n.TouchElement.ActionTypes.swipeLeft)},startSlideshow:function(){this.stopSlideshow();this.isSlideshowActive=!0;this.slideshowTimeout=e.setTimeout(this.slideshowNext.bind(this),this.settings.slideshowDelay);n.Events.fire(this,{type:r.Carousel.EventTypes.onSlideshowStart,target:this})},stopSlideshow:function(){n.isNothing(this.slideshowTimeout)||(e.clearTimeout(this.slideshowTimeout),this.slideshowTimeout=null,this.isSlideshowActive=!1,n.Events.fire(this,{type:r.Carousel.EventTypes.onSlideshowStop,target:this}))},onSlideByEnd:function(){if(!n.isNothing(this.isSliding)){var e=this.getItemEls();this.isSliding=!1;this.lastSlideByAction===r.Carousel.SlideByAction.next?this.currentCacheIndex+=1:this.lastSlideByAction===r.Carousel.SlideByAction.previous&&(this.currentCacheIndex-=1);this.settings.loop?(this.lastSlideByAction===r.Carousel.SlideByAction.next?n.DOM.appendChild(e[0],this.contentEl):this.lastSlideByAction===r.Carousel.SlideByAction.previous&&n.DOM.insertBefore(e[e.length-1],e[0],this.contentEl),this.currentCacheIndex<0)?this.currentCacheIndex=this.cache.images.length-1:this.currentCacheIndex===this.cache.images.length&&(this.currentCacheIndex=0):this.cache.images.length>3&&(this.currentCacheIndex>1&&this.currentCacheIndex<this.cache.images.length-2?this.lastSlideByAction===r.Carousel.SlideByAction.next?n.DOM.appendChild(e[0],this.contentEl):this.lastSlideByAction===r.Carousel.SlideByAction.previous&&n.DOM.insertBefore(e[e.length-1],e[0],this.contentEl):this.currentCacheIndex===1?this.lastSlideByAction===r.Carousel.SlideByAction.previous&&n.DOM.insertBefore(e[e.length-1],e[0],this.contentEl):this.currentCacheIndex===this.cache.images.length-2&&this.lastSlideByAction===r.Carousel.SlideByAction.next&&n.DOM.appendChild(e[0],this.contentEl));this.lastSlideByAction!==r.Carousel.SlideByAction.current&&(this.setContentLeftPosition(),this.setImages(!0));n.Events.fire(this,{type:r.Carousel.EventTypes.onSlideByEnd,target:this,action:this.lastSlideByAction,cacheIndex:this.currentCacheIndex});this.isSlideshowActive&&(this.lastSlideByAction!==r.Carousel.SlideByAction.current?this.startSlideshow():this.stopSlideshow())}},onTouch:function(t,r){this.stopSlideshow();switch(t){case n.TouchElement.ActionTypes.touchStart:this.touchStartPoint=r;this.touchStartPosition={x:e.parseInt(n.DOM.getStyle(this.contentEl,"left"),0),y:e.parseInt(n.DOM.getStyle(this.contentEl,"top"),0)};break;case n.TouchElement.ActionTypes.touchMove:this.moveCarousel(r);break;case n.TouchElement.ActionTypes.touchMoveEnd:case n.TouchElement.ActionTypes.swipeLeft:case n.TouchElement.ActionTypes.swipeRight:this.slideCarousel(r,t)}},onImageLoad:function(e){e=e.target;n.isNothing(e.imageEl.parentNode)||(n.DOM.removeClass(e.imageEl.parentNode,r.Carousel.CssClasses.itemLoading),this.resetImagePosition(e.imageEl));n.Events.remove(e,r.Image.EventTypes.onLoad,this.imageLoadHandler);n.Events.remove(e,r.Image.EventTypes.onError,this.imageErrorHandler)},onImageError:function(e){e=e.target;n.isNothing(e.imageEl.parentNode)||(n.DOM.removeClass(e.imageEl.parentNode,r.Carousel.CssClasses.itemLoading),n.DOM.addClass(e.imageEl.parentNode,r.Carousel.CssClasses.itemError));n.Events.remove(e,r.Image.EventTypes.onLoad,this.imageLoadHandler);n.Events.remove(e,r.Image.EventTypes.onError,this.imageErrorHandler)}})})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.Carousel");t=e.Code.PhotoSwipe;t.Carousel.CarouselClass=t.Carousel.CarouselClass.extend({getStartingPos:function(){var t=this.touchStartPosition;n.isNothing(t)&&(t={x:e.parseInt(n.DOM.getStyle(this.contentEl,"left"),0),y:e.parseInt(n.DOM.getStyle(this.contentEl,"top"),0)});return t},doMoveCarousel:function(t){var r;n.Browser.isCSSTransformSupported?(r={},r[n.Animation._transitionPrefix+"Property"]="all",r[n.Animation._transitionPrefix+"Duration"]="",r[n.Animation._transitionPrefix+"TimingFunction"]="",r[n.Animation._transitionPrefix+"Delay"]="0",r[n.Animation._transformLabel]=n.Browser.is3dSupported?"translate3d("+t+"px, 0px, 0px)":"translate("+t+"px, 0px)",n.DOM.setStyle(this.contentEl,r)):n.isNothing(e.jQuery)||e.jQuery(this.contentEl).stop().css("left",this.getStartingPos().x+t+"px")},doSlideCarousel:function(t,r){var i;if(r<=0)this.slideByEndHandler();else if(n.Browser.isCSSTransformSupported)i=n.coalesce(this.contentEl.style.webkitTransform,this.contentEl.style.MozTransform,this.contentEl.style.transform,""),i.indexOf("translate3d("+t)===0?this.slideByEndHandler():i.indexOf("translate("+t)===0?this.slideByEndHandler():n.Animation.slideBy(this.contentEl,t,0,r,this.slideByEndHandler,this.settings.slideTimingFunction);else if(!n.isNothing(e.jQuery)){i={left:this.getStartingPos().x+t+"px"};this.settings.animationTimingFunction==="ease-out"&&(this.settings.animationTimingFunction="easeOutQuad");n.isNothing(e.jQuery.easing[this.settings.animationTimingFunction])&&(this.settings.animationTimingFunction="linear");e.jQuery(this.contentEl).animate(i,this.settings.slideSpeed,this.settings.animationTimingFunction,this.slideByEndHandler)}}})})(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.TouchElement);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.Toolbar");var r=e.Code.PhotoSwipe;r.Toolbar.CssClasses={toolbar:"ps-toolbar",toolbarContent:"ps-toolbar-content",toolbarTop:"ps-toolbar-top",caption:"ps-caption",captionBottom:"ps-caption-bottom",captionContent:"ps-caption-content",close:"ps-toolbar-close",play:"ps-toolbar-play",previous:"ps-toolbar-previous",previousDisabled:"ps-toolbar-previous-disabled",next:"ps-toolbar-next",nextDisabled:"ps-toolbar-next-disabled"};r.Toolbar.ToolbarAction={close:"close",play:"play",next:"next",previous:"previous",none:"none"};r.Toolbar.EventTypes={onTap:"PhotoSwipeToolbarOnClick",onBeforeShow:"PhotoSwipeToolbarOnBeforeShow",onShow:"PhotoSwipeToolbarOnShow",onBeforeHide:"PhotoSwipeToolbarOnBeforeHide",onHide:"PhotoSwipeToolbarOnHide"};r.Toolbar.getToolbar=function(){return'<div class="'+r.Toolbar.CssClasses.close+'"><div class="'+r.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+r.Toolbar.CssClasses.play+'"><div class="'+r.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+r.Toolbar.CssClasses.previous+'"><div class="'+r.Toolbar.CssClasses.toolbarContent+'"></div></div><div class="'+r.Toolbar.CssClasses.next+'"><div class="'+r.Toolbar.CssClasses.toolbarContent+'"></div></div>'}})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.Toolbar");var r=e.Code.PhotoSwipe;r.Toolbar.ToolbarClass=t({toolbarEl:null,closeEl:null,playEl:null,previousEl:null,nextEl:null,captionEl:null,captionContentEl:null,currentCaption:null,settings:null,cache:null,timeout:null,isVisible:null,fadeOutHandler:null,touchStartHandler:null,touchMoveHandler:null,clickHandler:null,dispose:function(){var e;this.clearTimeout();this.removeEventHandlers();n.Animation.stop(this.toolbarEl);n.Animation.stop(this.captionEl);n.DOM.removeChild(this.toolbarEl,this.toolbarEl.parentNode);n.DOM.removeChild(this.captionEl,this.captionEl.parentNode);for(e in this)n.objectHasProperty(this,e)&&(this[e]=null)},initialize:function(t,i){var s;this.settings=i;this.cache=t;this.isVisible=!1;this.fadeOutHandler=this.onFadeOut.bind(this);this.touchStartHandler=this.onTouchStart.bind(this);this.touchMoveHandler=this.onTouchMove.bind(this);this.clickHandler=this.onClick.bind(this);s=r.Toolbar.CssClasses.toolbar;this.settings.captionAndToolbarFlipPosition&&(s=s+" "+r.Toolbar.CssClasses.toolbarTop);this.toolbarEl=n.DOM.createElement("div",{"class":s},this.settings.getToolbar());n.DOM.setStyle(this.toolbarEl,{left:0,position:"absolute",overflow:"hidden",zIndex:this.settings.zIndex});this.settings.target===e?n.DOM.appendToBody(this.toolbarEl):n.DOM.appendChild(this.toolbarEl,this.settings.target);n.DOM.hide(this.toolbarEl);this.closeEl=n.DOM.find("."+r.Toolbar.CssClasses.close,this.toolbarEl)[0];this.settings.preventHide&&!n.isNothing(this.closeEl)&&n.DOM.hide(this.closeEl);this.playEl=n.DOM.find("."+r.Toolbar.CssClasses.play,this.toolbarEl)[0];this.settings.preventSlideshow&&!n.isNothing(this.playEl)&&n.DOM.hide(this.playEl);this.nextEl=n.DOM.find("."+r.Toolbar.CssClasses.next,this.toolbarEl)[0];this.previousEl=n.DOM.find("."+r.Toolbar.CssClasses.previous,this.toolbarEl)[0];s=r.Toolbar.CssClasses.caption;this.settings.captionAndToolbarFlipPosition&&(s=s+" "+r.Toolbar.CssClasses.captionBottom);this.captionEl=n.DOM.createElement("div",{"class":s},"");n.DOM.setStyle(this.captionEl,{left:0,position:"absolute",overflow:"hidden",zIndex:this.settings.zIndex});this.settings.target===e?n.DOM.appendToBody(this.captionEl):n.DOM.appendChild(this.captionEl,this.settings.target);n.DOM.hide(this.captionEl);this.captionContentEl=n.DOM.createElement("div",{"class":r.Toolbar.CssClasses.captionContent},"");n.DOM.appendChild(this.captionContentEl,this.captionEl);this.addEventHandlers()},resetPosition:function(){var t,r,i;this.settings.target===e?(this.settings.captionAndToolbarFlipPosition?(r=n.DOM.windowScrollTop(),i=n.DOM.windowScrollTop()+n.DOM.windowHeight()-n.DOM.height(this.captionEl)):(r=n.DOM.windowScrollTop()+n.DOM.windowHeight()-n.DOM.height(this.toolbarEl),i=n.DOM.windowScrollTop()),t=n.DOM.windowWidth()):(this.settings.captionAndToolbarFlipPosition?(r="0",i=n.DOM.height(this.settings.target)-n.DOM.height(this.captionEl)):(r=n.DOM.height(this.settings.target)-n.DOM.height(this.toolbarEl),i=0),t=n.DOM.width(this.settings.target));n.DOM.setStyle(this.toolbarEl,{top:r+"px",width:t});n.DOM.setStyle(this.captionEl,{top:i+"px",width:t})},toggleVisibility:function(e){this.isVisible?this.fadeOut():this.show(e)},show:function(e){n.Animation.stop(this.toolbarEl);n.Animation.stop(this.captionEl);this.resetPosition();this.setToolbarStatus(e);n.Events.fire(this,{type:r.Toolbar.EventTypes.onBeforeShow,target:this});this.showToolbar();this.setCaption(e);this.showCaption();this.isVisible=!0;this.setTimeout();n.Events.fire(this,{type:r.Toolbar.EventTypes.onShow,target:this})},setTimeout:function(){this.settings.captionAndToolbarAutoHideDelay>0&&(this.clearTimeout(),this.timeout=e.setTimeout(this.fadeOut.bind(this),this.settings.captionAndToolbarAutoHideDelay))},clearTimeout:function(){n.isNothing(this.timeout)||(e.clearTimeout(this.timeout),this.timeout=null)},fadeOut:function(){this.clearTimeout();n.Events.fire(this,{type:r.Toolbar.EventTypes.onBeforeHide,target:this});n.Animation.fadeOut(this.toolbarEl,this.settings.fadeOutSpeed);n.Animation.fadeOut(this.captionEl,this.settings.fadeOutSpeed,this.fadeOutHandler);this.isVisible=!1},addEventHandlers:function(){n.Browser.isTouchSupported&&(n.Browser.blackberry||n.Events.add(this.toolbarEl,"touchstart",this.touchStartHandler),n.Events.add(this.toolbarEl,"touchmove",this.touchMoveHandler),n.Events.add(this.captionEl,"touchmove",this.touchMoveHandler));n.Events.add(this.toolbarEl,"click",this.clickHandler)},removeEventHandlers:function(){n.Browser.isTouchSupported&&(n.Browser.blackberry||n.Events.remove(this.toolbarEl,"touchstart",this.touchStartHandler),n.Events.remove(this.toolbarEl,"touchmove",this.touchMoveHandler),n.Events.remove(this.captionEl,"touchmove",this.touchMoveHandler));n.Events.remove(this.toolbarEl,"click",this.clickHandler)},handleTap:function(e){this.clearTimeout();var t;if(e.target===this.nextEl||n.DOM.isChildOf(e.target,this.nextEl))t=r.Toolbar.ToolbarAction.next;else if(e.target===this.previousEl||n.DOM.isChildOf(e.target,this.previousEl))t=r.Toolbar.ToolbarAction.previous;else if(e.target===this.closeEl||n.DOM.isChildOf(e.target,this.closeEl))t=r.Toolbar.ToolbarAction.close;else if(e.target===this.playEl||n.DOM.isChildOf(e.target,this.playEl))t=r.Toolbar.ToolbarAction.play;this.setTimeout();n.isNothing(t)&&(t=r.Toolbar.ToolbarAction.none);n.Events.fire(this,{type:r.Toolbar.EventTypes.onTap,target:this,action:t,tapTarget:e.target})},setCaption:function(e){n.DOM.removeChildren(this.captionContentEl);this.currentCaption=n.coalesce(this.cache.images[e].caption,"");if(n.isObject(this.currentCaption))n.DOM.appendChild(this.currentCaption,this.captionContentEl);else{this.currentCaption===""&&(this.currentCaption="");n.DOM.appendText(this.currentCaption,this.captionContentEl)}this.currentCaption=this.currentCaption===""?"":this.currentCaption;this.resetPosition()},showToolbar:function(){n.DOM.setStyle(this.toolbarEl,{opacity:this.settings.captionAndToolbarOpacity});n.DOM.show(this.toolbarEl)},showCaption:function(){(this.currentCaption===""||this.captionContentEl.childNodes.length<1)&&!this.settings.captionAndToolbarShowEmptyCaptions?n.DOM.hide(this.captionEl):(n.DOM.setStyle(this.captionEl,{opacity:this.settings.captionAndToolbarOpacity}),n.DOM.show(this.captionEl))},setToolbarStatus:function(e){this.settings.loop||(n.DOM.removeClass(this.previousEl,r.Toolbar.CssClasses.previousDisabled),n.DOM.removeClass(this.nextEl,r.Toolbar.CssClasses.nextDisabled),e>0&&e<this.cache.images.length-1||(e===0&&(n.isNothing(this.previousEl)||n.DOM.addClass(this.previousEl,r.Toolbar.CssClasses.previousDisabled)),e===this.cache.images.length-1&&(n.isNothing(this.nextEl)||n.DOM.addClass(this.nextEl,r.Toolbar.CssClasses.nextDisabled))))},onFadeOut:function(){n.DOM.hide(this.toolbarEl);n.DOM.hide(this.captionEl);n.Events.fire(this,{type:r.Toolbar.EventTypes.onHide,target:this})},onTouchStart:function(e){e.preventDefault();n.Events.remove(this.toolbarEl,"click",this.clickHandler);this.handleTap(e)},onTouchMove:function(e){e.preventDefault()},onClick:function(e){e.preventDefault();this.handleTap(e)}})})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.UILayer");e.Code.PhotoSwipe.UILayer.CssClasses={uiLayer:"ps-uilayer"}})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.UILayer");var r=e.Code.PhotoSwipe;r.UILayer.UILayerClass=n.TouchElement.TouchElementClass.extend({el:null,settings:null,dispose:function(){var e;this.removeEventHandlers();n.DOM.removeChild(this.el,this.el.parentNode);for(e in this)n.objectHasProperty(this,e)&&(this[e]=null)},initialize:function(t){this.settings=t;this.el=n.DOM.createElement("div",{"class":r.UILayer.CssClasses.uiLayer},"");n.DOM.setStyle(this.el,{display:"block",position:"absolute",left:0,top:0,overflow:"hidden",zIndex:this.settings.zIndex,opacity:0});n.DOM.hide(this.el);this.settings.target===e?n.DOM.appendToBody(this.el):n.DOM.appendChild(this.el,this.settings.target);this.supr(this.el,{swipe:!0,move:!0,gesture:n.Browser.iOS,doubleTap:!0,preventDefaultTouchEvents:this.settings.preventDefaultTouchEvents})},resetPosition:function(){this.settings.target===e?n.DOM.setStyle(this.el,{top:n.DOM.windowScrollTop()+"px",width:n.DOM.windowWidth(),height:n.DOM.windowHeight()}):n.DOM.setStyle(this.el,{top:"0px",width:n.DOM.width(this.settings.target),height:n.DOM.height(this.settings.target)})},show:function(){this.resetPosition();n.DOM.show(this.el);this.addEventHandlers()},addEventHandlers:function(){this.supr()},removeEventHandlers:function(){this.supr()}})})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.ZoomPanRotate");e=e.Code.PhotoSwipe;e.ZoomPanRotate.CssClasses={zoomPanRotate:"ps-zoom-pan-rotate"};e.ZoomPanRotate.EventTypes={onTransform:"PhotoSwipeZoomPanRotateOnTransform"}})(window,window.klass,window.Code.Util);(function(e,t,n){n.registerNamespace("Code.PhotoSwipe.ZoomPanRotate");var r=e.Code.PhotoSwipe;r.ZoomPanRotate.ZoomPanRotateClass=t({el:null,settings:null,containerEl:null,imageEl:null,transformSettings:null,panStartingPoint:null,transformEl:null,dispose:function(){var e;n.DOM.removeChild(this.el,this.el.parentNode);for(e in this)n.objectHasProperty(this,e)&&(this[e]=null)},initialize:function(t,i,s){var o,u,f;this.settings=t;this.settings.target===e?(t=document.body,o=n.DOM.windowWidth(),u=n.DOM.windowHeight(),f=n.DOM.windowScrollTop()+"px"):(t=this.settings.target,o=n.DOM.width(t),u=n.DOM.height(t),f="0px");this.imageEl=i.imageEl.cloneNode(!1);n.DOM.setStyle(this.imageEl,{zIndex:1});this.transformSettings={startingScale:1,scale:1,startingRotation:0,rotation:0,startingTranslateX:0,startingTranslateY:0,translateX:0,translateY:0};this.el=n.DOM.createElement("div",{"class":r.ZoomPanRotate.CssClasses.zoomPanRotate},"");n.DOM.setStyle(this.el,{left:0,top:f,position:"absolute",width:o,height:u,zIndex:this.settings.zIndex,display:"block"});n.DOM.insertBefore(this.el,s.el,t);n.Browser.iOS?(this.containerEl=n.DOM.createElement("div"),n.DOM.setStyle(this.containerEl,{left:0,top:0,width:o,height:u,position:"absolute",zIndex:1}),n.DOM.appendChild(this.imageEl,this.containerEl),n.DOM.appendChild(this.containerEl,this.el),n.Animation.resetTranslate(this.containerEl),n.Animation.resetTranslate(this.imageEl),this.transformEl=this.containerEl):(n.DOM.appendChild(this.imageEl,this.el),this.transformEl=this.imageEl)},setStartingTranslateFromCurrentTransform:function(){var t=n.coalesce(this.transformEl.style.webkitTransform,this.transformEl.style.MozTransform,this.transformEl.style.transform);!n.isNothing(t)&&(t=t.match(/translate\((.*?)\)/),!n.isNothing(t))&&(t=t[1].split(", "),this.transformSettings.startingTranslateX=e.parseInt(t[0],10),this.transformSettings.startingTranslateY=e.parseInt(t[1],10))},getScale:function(e){e*=this.transformSettings.startingScale;this.settings.minUserZoom!==0&&e<this.settings.minUserZoom?e=this.settings.minUserZoom:this.settings.maxUserZoom!==0&&e>this.settings.maxUserZoom&&(e=this.settings.maxUserZoom);return e},setStartingScaleAndRotation:function(e,t){this.transformSettings.startingScale=this.getScale(e);this.transformSettings.startingRotation=(this.transformSettings.startingRotation+t)%360},zoomRotate:function(e,t){this.transformSettings.scale=this.getScale(e);this.transformSettings.rotation=this.transformSettings.startingRotation+t;this.applyTransform()},panStart:function(e){this.setStartingTranslateFromCurrentTransform();this.panStartingPoint={x:e.x,y:e.y}},pan:function(e){var t=(e.y-this.panStartingPoint.y)/this.transformSettings.scale;this.transformSettings.translateX=this.transformSettings.startingTranslateX+(e.x-this.panStartingPoint.x)/this.transformSettings.scale;this.transformSettings.translateY=this.transformSettings.startingTranslateY+t;this.applyTransform()},zoomAndPanToPoint:function(t,r){if(this.settings.target===e){this.panStart({x:n.DOM.windowWidth()/2,y:n.DOM.windowHeight()/2});var i=(r.y-this.panStartingPoint.y)/this.transformSettings.scale;this.transformSettings.translateX=(this.transformSettings.startingTranslateX+(r.x-this.panStartingPoint.x)/this.transformSettings.scale)*-1;this.transformSettings.translateY=(this.transformSettings.startingTranslateY+i)*-1}this.setStartingScaleAndRotation(t,0);this.transformSettings.scale=this.transformSettings.startingScale;this.transformSettings.rotation=0;this.applyTransform()},applyTransform:function(){var t=this.transformSettings.rotation%360,i=e.parseInt(this.transformSettings.translateX,10),s=e.parseInt(this.transformSettings.translateY,10),o="scale("+this.transformSettings.scale+") rotate("+t+"deg) translate("+i+"px, "+s+"px)";n.DOM.setStyle(this.transformEl,{webkitTransform:o,MozTransform:o,msTransform:o,transform:o});n.Events.fire(this,{target:this,type:r.ZoomPanRotate.EventTypes.onTransform,scale:this.transformSettings.scale,rotation:this.transformSettings.rotation,rotationDegs:t,translateX:i,translateY:s})}})})(window,window.klass,window.Code.Util);(function(e,t){t.registerNamespace("Code.PhotoSwipe");var n=e.Code.PhotoSwipe;n.CssClasses={buildingBody:"ps-building",activeBody:"ps-active"};n.EventTypes={onBeforeShow:"PhotoSwipeOnBeforeShow",onShow:"PhotoSwipeOnShow",onBeforeHide:"PhotoSwipeOnBeforeHide",onHide:"PhotoSwipeOnHide",onDisplayImage:"PhotoSwipeOnDisplayImage",onResetPosition:"PhotoSwipeOnResetPosition",onSlideshowStart:"PhotoSwipeOnSlideshowStart",onSlideshowStop:"PhotoSwipeOnSlideshowStop",onTouch:"PhotoSwipeOnTouch",onBeforeCaptionAndToolbarShow:"PhotoSwipeOnBeforeCaptionAndToolbarShow",onCaptionAndToolbarShow:"PhotoSwipeOnCaptionAndToolbarShow",onBeforeCaptionAndToolbarHide:"PhotoSwipeOnBeforeCaptionAndToolbarHide",onCaptionAndToolbarHide:"PhotoSwipeOnCaptionAndToolbarHide",onToolbarTap:"PhotoSwipeOnToolbarTap",onBeforeZoomPanRotateShow:"PhotoSwipeOnBeforeZoomPanRotateShow",onZoomPanRotateShow:"PhotoSwipeOnZoomPanRotateShow",onBeforeZoomPanRotateHide:"PhotoSwipeOnBeforeZoomPanRotateHide",onZoomPanRotateHide:"PhotoSwipeOnZoomPanRotateHide",onZoomPanRotateTransform:"PhotoSwipeOnZoomPanRotateTransform"};n.instances=[];n.activeInstances=[];n.setActivateInstance=function(e){if(t.arrayIndexOf(e.settings.target,n.activeInstances,"target")>-1)throw"Code.PhotoSwipe.activateInstance: Unable to active instance as another instance is already active for this target";n.activeInstances.push({target:e.settings.target,instance:e})};n.unsetActivateInstance=function(e){e=t.arrayIndexOf(e,n.activeInstances,"instance");n.activeInstances.splice(e,1)};n.attach=function(e,r,i){var s,o;s=n.createInstance(e,r,i);r=0;for(i=e.length;r<i;r++)if(o=e[r],!t.isNothing(o.nodeType)&&o.nodeType===1)o.__photoSwipeClickHandler=n.onTriggerElementClick.bind(s),t.Events.remove(o,"click",o.__photoSwipeClickHandler),t.Events.add(o,"click",o.__photoSwipeClickHandler);return s};e.jQuery&&(e.jQuery.fn.photoSwipe=function(e,t){return n.attach(this,e,t)});n.detatch=function(e){var r,i,s;r=0;for(i=e.originalImages.length;r<i;r++)s=e.originalImages[r],!t.isNothing(s.nodeType)&&s.nodeType===1&&(t.Events.remove(s,"click",s.__photoSwipeClickHandler),delete s.__photoSwipeClickHandler);n.disposeInstance(e)};n.createInstance=function(e,r,i){var s;if(t.isNothing(e))throw"Code.PhotoSwipe.attach: No images passed.";if(!t.isLikeArray(e))throw"Code.PhotoSwipe.createInstance: Images must be an array of elements or image urls.";if(e.length<1)throw"Code.PhotoSwipe.createInstance: No images to passed.";r=t.coalesce(r,{});s=n.getInstance(i);if(!t.isNothing(s))throw'Code.PhotoSwipe.createInstance: Instance with id "'+i+' already exists."';s=new n.PhotoSwipeClass(e,r,i),n.instances.push(s);return s};n.disposeInstance=function(e){var t=n.getInstanceIndex(e);if(t<0)throw"Code.PhotoSwipe.disposeInstance: Unable to find instance to dispose.";e.dispose();n.instances.splice(t,1)};n.onTriggerElementClick=function(e){e.preventDefault();this.show(e.currentTarget)};n.getInstance=function(e){var t,r,i;t=0;for(r=n.instances.length;t<r;t++)if(i=n.instances[t],i.id===e)return i;return null};n.getInstanceIndex=function(e){var t,r,i=-1;t=0;for(r=n.instances.length;t<r;t++)if(n.instances[t]===e){i=t;break}return i}})(window,window.Code.Util);(function(e,t,n,r,i,s,o,u,a){n.registerNamespace("Code.PhotoSwipe");var f=e.Code.PhotoSwipe;f.PhotoSwipeClass=t({id:null,settings:null,isBackEventSupported:null,backButtonClicked:null,currentIndex:null,originalImages:null,mouseWheelStartTime:null,windowDimensions:null,cache:null,documentOverlay:null,carousel:null,uiLayer:null,toolbar:null,zoomPanRotate:null,windowOrientationChangeHandler:null,windowScrollHandler:null,windowHashChangeHandler:null,keyDownHandler:null,windowOrientationEventName:null,uiLayerTouchHandler:null,carouselSlideByEndHandler:null,carouselSlideshowStartHandler:null,carouselSlideshowStopHandler:null,toolbarTapHandler:null,toolbarBeforeShowHandler:null,toolbarShowHandler:null,toolbarBeforeHideHandler:null,toolbarHideHandler:null,mouseWheelHandler:null,zoomPanRotateTransformHandler:null,_isResettingPosition:null,_uiWebViewResetPositionTimeout:null,dispose:function(){var e;n.Events.remove(this,f.EventTypes.onBeforeShow);n.Events.remove(this,f.EventTypes.onShow);n.Events.remove(this,f.EventTypes.onBeforeHide);n.Events.remove(this,f.EventTypes.onHide);n.Events.remove(this,f.EventTypes.onDisplayImage);n.Events.remove(this,f.EventTypes.onResetPosition);n.Events.remove(this,f.EventTypes.onSlideshowStart);n.Events.remove(this,f.EventTypes.onSlideshowStop);n.Events.remove(this,f.EventTypes.onTouch);n.Events.remove(this,f.EventTypes.onBeforeCaptionAndToolbarShow);n.Events.remove(this,f.EventTypes.onCaptionAndToolbarShow);n.Events.remove(this,f.EventTypes.onBeforeCaptionAndToolbarHide);n.Events.remove(this,f.EventTypes.onCaptionAndToolbarHide);n.Events.remove(this,f.EventTypes.onZoomPanRotateTransform);this.removeEventHandlers();n.isNothing(this.documentOverlay)||this.documentOverlay.dispose();n.isNothing(this.carousel)||this.carousel.dispose();n.isNothing(this.uiLayer)||this.uiLayer.dispose();n.isNothing(this.toolbar)||this.toolbar.dispose();this.destroyZoomPanRotate();n.isNothing(this.cache)||this.cache.dispose();for(e in this)n.objectHasProperty(this,e)&&(this[e]=null)},initialize:function(t,i,s){this.id=n.isNothing(s)?"PhotoSwipe"+(new Date).getTime().toString():s;this.originalImages=t;n.Browser.android&&e.navigator.userAgent.match(/Android (\d+.\d+)/).toString().replace(/^.*\,/,"")>=2.1&&(this.isBackEventSupported=!0);this.isBackEventSupported||(this.isBackEventSupported=n.objectHasProperty(e,"onhashchange"));this.settings={fadeInSpeed:250,fadeOutSpeed:250,preventHide:!1,preventSlideshow:!1,zIndex:1e3,backButtonHideEnabled:!0,enableKeyboard:!0,enableMouseWheel:!0,mouseWheelSpeed:350,autoStartSlideshow:!1,jQueryMobile:!n.isNothing(e.jQuery)&&!n.isNothing(e.jQuery.mobile),jQueryMobileDialogHash:"&ui-state=dialog",enableUIWebViewRepositionTimeout:!1,uiWebViewResetPositionDelay:500,target:e,preventDefaultTouchEvents:!0,loop:!0,slideSpeed:250,nextPreviousSlideSpeed:0,enableDrag:!0,swipeThreshold:50,swipeTimeThreshold:250,slideTimingFunction:"ease-out",slideshowDelay:3e3,doubleTapSpeed:250,margin:20,imageScaleMethod:"fit",captionAndToolbarHide:!1,captionAndToolbarFlipPosition:!1,captionAndToolbarAutoHideDelay:5e3,captionAndToolbarOpacity:.8,captionAndToolbarShowEmptyCaptions:!0,getToolbar:f.Toolbar.getToolbar,allowUserZoom:!0,allowRotationOnUserZoom:!1,maxUserZoom:5,minUserZoom:.5,doubleTapZoomLevel:2.5,getImageSource:f.Cache.Functions.getImageSource,getImageCaption:f.Cache.Functions.getImageCaption,getImageMetaData:f.Cache.Functions.getImageMetaData,cacheMode:f.Cache.Mode.normal};n.extend(this.settings,i);this
.settings.target!==e&&(i=n.DOM.getStyle(this.settings.target,"position"),(i!=="relative"||i!=="absolute")&&n.DOM.setStyle(this.settings.target,"position","relative"));this.settings.target!==e?(this.isBackEventSupported=!1,this.settings.backButtonHideEnabled=!1):this.settings.preventHide&&(this.settings.backButtonHideEnabled=!1);this.cache=new r.CacheClass(t,this.settings)},show:function(t){var r,i;this.backButtonClicked=this._isResettingPosition=!1;if(n.isNumber(t))this.currentIndex=t;else{this.currentIndex=-1;r=0;for(i=this.originalImages.length;r<i;r++)if(this.originalImages[r]===t){this.currentIndex=r;break}}if(this.currentIndex<0||this.currentIndex>this.originalImages.length-1)throw"Code.PhotoSwipe.PhotoSwipeClass.show: Starting index out of range";this.isAlreadyGettingPage=this.getWindowDimensions();f.setActivateInstance(this);this.windowDimensions=this.getWindowDimensions();this.settings.target===e?n.DOM.addClass(e.document.body,f.CssClasses.buildingBody):n.DOM.addClass(this.settings.target,f.CssClasses.buildingBody);this.createComponents();n.Events.fire(this,{type:f.EventTypes.onBeforeShow,target:this});this.documentOverlay.fadeIn(this.settings.fadeInSpeed,this.onDocumentOverlayFadeIn.bind(this))},getWindowDimensions:function(){return{width:n.DOM.windowWidth(),height:n.DOM.windowHeight()}},createComponents:function(){this.documentOverlay=new i.DocumentOverlayClass(this.settings);this.carousel=new s.CarouselClass(this.cache,this.settings);this.uiLayer=new u.UILayerClass(this.settings);this.settings.captionAndToolbarHide||(this.toolbar=new o.ToolbarClass(this.cache,this.settings))},resetPosition:function(){if(!this._isResettingPosition){var e=this.getWindowDimensions();if(n.isNothing(this.windowDimensions)||e.width!==this.windowDimensions.width||e.height!==this.windowDimensions.height)this._isResettingPosition=!0,this.windowDimensions=e,this.destroyZoomPanRotate(),this.documentOverlay.resetPosition(),this.carousel.resetPosition(),n.isNothing(this.toolbar)||this.toolbar.resetPosition(),this.uiLayer.resetPosition(),this._isResettingPosition=!1,n.Events.fire(this,{type:f.EventTypes.onResetPosition,target:this})}},addEventHandler:function(e,t){n.Events.add(this,e,t)},addEventHandlers:function(){n.isNothing(this.windowOrientationChangeHandler)&&(this.windowOrientationChangeHandler=this.onWindowOrientationChange.bind(this),this.windowScrollHandler=this.onWindowScroll.bind(this),this.keyDownHandler=this.onKeyDown.bind(this),this.windowHashChangeHandler=this.onWindowHashChange.bind(this),this.uiLayerTouchHandler=this.onUILayerTouch.bind(this),this.carouselSlideByEndHandler=this.onCarouselSlideByEnd.bind(this),this.carouselSlideshowStartHandler=this.onCarouselSlideshowStart.bind(this),this.carouselSlideshowStopHandler=this.onCarouselSlideshowStop.bind(this),this.toolbarTapHandler=this.onToolbarTap.bind(this),this.toolbarBeforeShowHandler=this.onToolbarBeforeShow.bind(this),this.toolbarShowHandler=this.onToolbarShow.bind(this),this.toolbarBeforeHideHandler=this.onToolbarBeforeHide.bind(this),this.toolbarHideHandler=this.onToolbarHide.bind(this),this.mouseWheelHandler=this.onMouseWheel.bind(this),this.zoomPanRotateTransformHandler=this.onZoomPanRotateTransform.bind(this));n.Browser.android?this.orientationEventName="resize":n.Browser.iOS&&!n.Browser.safari?n.Events.add(e.document.body,"orientationchange",this.windowOrientationChangeHandler):this.orientationEventName=n.isNothing(e.onorientationchange)?"resize":"orientationchange";n.isNothing(this.orientationEventName)||n.Events.add(e,this.orientationEventName,this.windowOrientationChangeHandler);this.settings.target===e&&n.Events.add(e,"scroll",this.windowScrollHandler);this.settings.enableKeyboard&&n.Events.add(e.document,"keydown",this.keyDownHandler);this.isBackEventSupported&&this.settings.backButtonHideEnabled&&(this.windowHashChangeHandler=this.onWindowHashChange.bind(this),this.settings.jQueryMobile?e.location.hash=this.settings.jQueryMobileDialogHash:(this.currentHistoryHashValue="PhotoSwipe"+(new Date).getTime().toString(),e.location.hash=this.currentHistoryHashValue),n.Events.add(e,"hashchange",this.windowHashChangeHandler));this.settings.enableMouseWheel&&n.Events.add(e,"mousewheel",this.mouseWheelHandler);n.Events.add(this.uiLayer,n.TouchElement.EventTypes.onTouch,this.uiLayerTouchHandler);n.Events.add(this.carousel,s.EventTypes.onSlideByEnd,this.carouselSlideByEndHandler);n.Events.add(this.carousel,s.EventTypes.onSlideshowStart,this.carouselSlideshowStartHandler);n.Events.add(this.carousel,s.EventTypes.onSlideshowStop,this.carouselSlideshowStopHandler);n.isNothing(this.toolbar)||(n.Events.add(this.toolbar,o.EventTypes.onTap,this.toolbarTapHandler),n.Events.add(this.toolbar,o.EventTypes.onBeforeShow,this.toolbarBeforeShowHandler),n.Events.add(this.toolbar,o.EventTypes.onShow,this.toolbarShowHandler),n.Events.add(this.toolbar,o.EventTypes.onBeforeHide,this.toolbarBeforeHideHandler),n.Events.add(this.toolbar,o.EventTypes.onHide,this.toolbarHideHandler))},removeEventHandlers:function(){n.Browser.iOS&&!n.Browser.safari&&n.Events.remove(e.document.body,"orientationchange",this.windowOrientationChangeHandler);n.isNothing(this.orientationEventName)||n.Events.remove(e,this.orientationEventName,this.windowOrientationChangeHandler);n.Events.remove(e,"scroll",this.windowScrollHandler);this.settings.enableKeyboard&&n.Events.remove(e.document,"keydown",this.keyDownHandler);this.isBackEventSupported&&this.settings.backButtonHideEnabled&&n.Events.remove(e,"hashchange",this.windowHashChangeHandler);this.settings.enableMouseWheel&&n.Events.remove(e,"mousewheel",this.mouseWheelHandler);n.isNothing(this.uiLayer)||n.Events.remove(this.uiLayer,n.TouchElement.EventTypes.onTouch,this.uiLayerTouchHandler);n.isNothing(this.toolbar)||(n.Events.remove(this.carousel,s.EventTypes.onSlideByEnd,this.carouselSlideByEndHandler),n.Events.remove(this.carousel,s.EventTypes.onSlideshowStart,this.carouselSlideshowStartHandler),n.Events.remove(this.carousel,s.EventTypes.onSlideshowStop,this.carouselSlideshowStopHandler));n.isNothing(this.toolbar)||(n.Events.remove(this.toolbar,o.EventTypes.onTap,this.toolbarTapHandler),n.Events.remove(this.toolbar,o.EventTypes.onBeforeShow,this.toolbarBeforeShowHandler),n.Events.remove(this.toolbar,o.EventTypes.onShow,this.toolbarShowHandler),n.Events.remove(this.toolbar,o.EventTypes.onBeforeHide,this.toolbarBeforeHideHandler),n.Events.remove(this.toolbar,o.EventTypes.onHide,this.toolbarHideHandler))},hide:function(){if(!this.settings.preventHide){if(n.isNothing(this.documentOverlay))throw"Code.PhotoSwipe.PhotoSwipeClass.hide: PhotoSwipe instance is already hidden";if(n.isNothing(this.hiding)){this.clearUIWebViewResetPositionTimeout();this.destroyZoomPanRotate();this.removeEventHandlers();n.Events.fire(this,{type:f.EventTypes.onBeforeHide,target:this});this.uiLayer.dispose();this.uiLayer=null;n.isNothing(this.toolbar)||(this.toolbar.dispose(),this.toolbar=null);this.carousel.dispose();this.carousel=null;n.DOM.removeClass(e.document.body,f.CssClasses.activeBody);this.documentOverlay.dispose();this.documentOverlay=null;this._isResettingPosition=!1;f.unsetActivateInstance(this);n.Events.fire(this,{type:f.EventTypes.onHide,target:this});this.goBackInHistory()}}},goBackInHistory:function(){this.isBackEventSupported&&this.settings.backButtonHideEnabled&&(this.backButtonClicked||e.history.back())},play:function(){!this.isZoomActive()&&!this.settings.preventSlideshow&&!n.isNothing(this.carousel)&&(!n.isNothing(this.toolbar)&&this.toolbar.isVisible&&this.toolbar.fadeOut(),this.carousel.startSlideshow())},stop:function(){this.isZoomActive()||n.isNothing(this.carousel)||this.carousel.stopSlideshow()},previous:function(){this.isZoomActive()||n.isNothing(this.carousel)||this.carousel.previous()},next:function(){this.isZoomActive()||n.isNothing(this.carousel)||this.carousel.next()},toggleToolbar:function(){this.isZoomActive()||n.isNothing(this.toolbar)||this.toolbar.toggleVisibility(this.currentIndex)},fadeOutToolbarIfVisible:function(){!n.isNothing(this.toolbar)&&this.toolbar.isVisible&&this.settings.captionAndToolbarAutoHideDelay>0&&this.toolbar.fadeOut()},createZoomPanRotate:function(){this.stop();this.canUserZoom()&&!this.isZoomActive()&&(n.Events.fire(this,f.EventTypes.onBeforeZoomPanRotateShow),this.zoomPanRotate=new a.ZoomPanRotateClass(this.settings,this.cache.images[this.currentIndex],this.uiLayer),this.uiLayer.captureSettings.preventDefaultTouchEvents=!0,n.Events.add(this.zoomPanRotate,f.ZoomPanRotate.EventTypes.onTransform,this.zoomPanRotateTransformHandler),n.Events.fire(this,f.EventTypes.onZoomPanRotateShow),!n.isNothing(this.toolbar)&&this.toolbar.isVisible&&this.toolbar.fadeOut())},destroyZoomPanRotate:function(){n.isNothing(this.zoomPanRotate)||(n.Events.fire(this,f.EventTypes.onBeforeZoomPanRotateHide),n.Events.remove(this.zoomPanRotate,f.ZoomPanRotate.EventTypes.onTransform,this.zoomPanRotateTransformHandler),this.zoomPanRotate.dispose(),this.zoomPanRotate=null,this.uiLayer.captureSettings.preventDefaultTouchEvents=this.settings.preventDefaultTouchEvents,n.Events.fire(this,f.EventTypes.onZoomPanRotateHide))},canUserZoom:function(){var e;if(n.Browser.msie){if(e=document.createElement("div"),n.isNothing(e.style.msTransform))return!1}else if(!n.Browser.isCSSTransformSupported)return!1;if(!this.settings.allowUserZoom)return!1;if(this.carousel.isSliding)return!1;e=this.cache.images[this.currentIndex];return n.isNothing(e)?!1:e.isLoading?!1:!0},isZoomActive:function(){return!n.isNothing(this.zoomPanRotate)},getCurrentImage:function(){return this.cache.images[this.currentIndex]},onDocumentOverlayFadeIn:function(){e.setTimeout(function(){var t=this.settings.target===e?e.document.body:this.settings.target;n.DOM.removeClass(t,f.CssClasses.buildingBody);n.DOM.addClass(t,f.CssClasses.activeBody);this.addEventHandlers();this.carousel.show(this.currentIndex);this.uiLayer.show();this.settings.autoStartSlideshow?this.play():n.isNothing(this.toolbar)||this.toolbar.show(this.currentIndex);n.Events.fire(this,{type:f.EventTypes.onShow,target:this});this.setUIWebViewResetPositionTimeout()}.bind(this),250)},setUIWebViewResetPositionTimeout:function(){this.settings.enableUIWebViewRepositionTimeout&&n.Browser.iOS&&!n.Browser.safari&&(n.isNothing(this._uiWebViewResetPositionTimeout)||e.clearTimeout(this._uiWebViewResetPositionTimeout),this._uiWebViewResetPositionTimeout=e.setTimeout(function(){this.resetPosition();this.setUIWebViewResetPositionTimeout()}.bind(this),this.settings.uiWebViewResetPositionDelay))},clearUIWebViewResetPositionTimeout:function(){n.isNothing(this._uiWebViewResetPositionTimeout)||e.clearTimeout(this._uiWebViewResetPositionTimeout)},onWindowScroll:function(){this.resetPosition()},onWindowOrientationChange:function(){this.resetPosition()},onWindowHashChange:function(){e.location.hash!=="#"+(this.settings.jQueryMobile?this.settings.jQueryMobileDialogHash:this.currentHistoryHashValue)&&(this.backButtonClicked=!0,this.hide())},onKeyDown:function(e){e.keyCode===37?(e.preventDefault(),this.previous()):e.keyCode===39?(e.preventDefault(),this.next()):e.keyCode===38||e.keyCode===40?e.preventDefault():e.keyCode===27?(e.preventDefault(),this.hide()):e.keyCode===32?(this.settings.hideToolbar?this.hide():this.toggleToolbar(),e.preventDefault()):e.keyCode===13&&(e.preventDefault(),this.play())},onUILayerTouch:function(t){if(this.isZoomActive())switch(t.action){case n.TouchElement.ActionTypes.gestureChange:this.zoomPanRotate.zoomRotate(t.scale,this.settings.allowRotationOnUserZoom?t.rotation:0);break;case n.TouchElement.ActionTypes.gestureEnd:this.zoomPanRotate.setStartingScaleAndRotation(t.scale,this.settings.allowRotationOnUserZoom?t.rotation:0);break;case n.TouchElement.ActionTypes.touchStart:this.zoomPanRotate.panStart(t.point);break;case n.TouchElement.ActionTypes.touchMove:this.zoomPanRotate.pan(t.point);break;case n.TouchElement.ActionTypes.doubleTap:this.destroyZoomPanRotate();this.toggleToolbar();break;case n.TouchElement.ActionTypes.swipeLeft:this.destroyZoomPanRotate();this.next();this.toggleToolbar();break;case n.TouchElement.ActionTypes.swipeRight:this.destroyZoomPanRotate(),this.previous(),this.toggleToolbar()}else switch(t.action){case n.TouchElement.ActionTypes.touchMove:case n.TouchElement.ActionTypes.swipeLeft:case n.TouchElement.ActionTypes.swipeRight:this.fadeOutToolbarIfVisible();this.carousel.onTouch(t.action,t.point);break;case n.TouchElement.ActionTypes.touchStart:case n.TouchElement.ActionTypes.touchMoveEnd:this.carousel.onTouch(t.action,t.point);break;case n.TouchElement.ActionTypes.tap:this.toggleToolbar();break;case n.TouchElement.ActionTypes.doubleTap:this.settings.target===e&&(t.point.x-=n.DOM.windowScrollLeft(),t.point.y-=n.DOM.windowScrollTop());var r=this.cache.images[this.currentIndex].imageEl,i=e.parseInt(n.DOM.getStyle(r,"top"),10),s=e.parseInt(n.DOM.getStyle(r,"left"),10),o=s+n.DOM.width(r),r=i+n.DOM.height(r);t.point.x<s?t.point.x=s:t.point.x>o&&(t.point.x=o);t.point.y<i?t.point.y=i:t.point.y>r&&(t.point.y=r);this.createZoomPanRotate();this.isZoomActive()&&this.zoomPanRotate.zoomAndPanToPoint(this.settings.doubleTapZoomLevel,t.point);break;case n.TouchElement.ActionTypes.gestureStart:this.createZoomPanRotate()}n.Events.fire(this,{type:f.EventTypes.onTouch,target:this,point:t.point,action:t.action})},onCarouselSlideByEnd:function(e){this.currentIndex=e.cacheIndex;n.isNothing(this.toolbar)||(this.toolbar.setCaption(this.currentIndex),this.toolbar.setToolbarStatus(this.currentIndex));n.Events.fire(this,{type:f.EventTypes.onDisplayImage,target:this,action:e.action,index:e.cacheIndex})},onToolbarTap:function(e){switch(e.action){case o.ToolbarAction.next:this.next();break;case o.ToolbarAction.previous:this.previous();break;case o.ToolbarAction.close:this.hide();break;case o.ToolbarAction.play:this.play()}n.Events.fire(this,{type:f.EventTypes.onToolbarTap,target:this,toolbarAction:e.action,tapTarget:e.tapTarget})},onMouseWheel:function(e){var t=n.Events.getWheelDelta(e);e.timeStamp-(this.mouseWheelStartTime||0)<this.settings.mouseWheelSpeed||(this.mouseWheelStartTime=e.timeStamp,this.settings.invertMouseWheel&&(t*=-1),t<0?this.next():t>0&&this.previous())},onCarouselSlideshowStart:function(){n.Events.fire(this,{type:f.EventTypes.onSlideshowStart,target:this})},onCarouselSlideshowStop:function(){n.Events.fire(this,{type:f.EventTypes.onSlideshowStop,target:this})},onToolbarBeforeShow:function(){n.Events.fire(this,{type:f.EventTypes.onBeforeCaptionAndToolbarShow,target:this})},onToolbarShow:function(){n.Events.fire(this,{type:f.EventTypes.onCaptionAndToolbarShow,target:this})},onToolbarBeforeHide:function(){n.Events.fire(this,{type:f.EventTypes.onBeforeCaptionAndToolbarHide,target:this})},onToolbarHide:function(){n.Events.fire(this,{type:f.EventTypes.onCaptionAndToolbarHide,target:this})},onZoomPanRotateTransform:function(e){n.Events.fire(this,{target:this,type:f.EventTypes.onZoomPanRotateTransform,scale:e.scale,rotation:e.rotation,rotationDegs:e.rotationDegs,translateX:e.translateX,translateY:e.translateY})}})})(window,window.klass,window.Code.Util,window.Code.PhotoSwipe.Cache,window.Code.PhotoSwipe.DocumentOverlay,window.Code.PhotoSwipe.Carousel,window.Code.PhotoSwipe.Toolbar,window.Code.PhotoSwipe.UILayer,window.Code.PhotoSwipe.ZoomPanRotate);$.extend($.easing,{easeInQuad:function(e,t,n,r,i){return r*(t/=i)*t+n},easeInOutQuad:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t+n:-r/2*(--t*(t-2)-1)+n},easeInQuint:function(e,t,n,r,i){return r*(t/=i)*t*t*t*t+n},easeInOutQuint:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t*t*t*t+n:r/2*((t-=2)*t*t*t*t+2)+n},easeInOutBack:function(e,t,n,r,i,s){s==undefined&&(s=1.70158);return(t/=i/2)<1?r/2*t*t*(((s*=1.525)+1)*t-s)+n:r/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+n}});(function(e){var t=e.event,n,r;n=t.special.debouncedresize={setup:function(){e(this).on("resize",n.handler)},teardown:function(){e(this).off("resize",n.handler)},handler:function(e,i){var s=this,o=arguments,u=function(){e.type="debouncedresize";t.dispatch.apply(s,o)};r&&clearTimeout(r);i?u():r=setTimeout(u,n.threshold)},threshold:150}})(jQuery);var widthTester,scrollDisplayMenu;$(function(){widthTester=$(window).width();var e=$("#logo a"),t=$("#main-nav ul li:nth-child(1) a"),n=$("#main-nav ul li:nth-child(2) a"),r=$("#main-nav ul li:nth-child(3) a"),i=$("#main-nav ul li:nth-child(4) a"),s=$("#main-nav ul li:nth-child(5) a");$("#container").prepend('<div id="loading"><span class="outer"><span class="inner"></span></span>&nbsp;Loading<div class="loading-slow">Seems to be taking ages to load... Click <a href="#" id="refresh">here</a> to refresh the page and try again, or <a href="#" id="show-content">here</a> to show what has loaded so far.</div></div>');setTimeout(function(){$(".loading-slow").fadeIn(500)},5e3);$("#refresh").click(function(){location.reload();return!1});$("#show-content").click(function(){$("#loading").fadeOut(500,function(){$(this).remove();$(".pattern").removeClass("pattern-closed");$(window).width()>768?setTimeout(function(){$("#content").removeClass("loading")},550):$("#content").removeClass("loading")});return!1});$("#logo").append("<span></span>");$("#main-nav ul li").append("<span></span>");$("body").prepend('<span id="header-bg"></span>');scrollDisplayMenu=function(){var o=$(window).width(),u=$(document).scrollTop(),a=$("#header-bg"),f=$("header");if(u>=100&&!f.hasClass("fixed")&&o>1024){a.addClass("open");f.addClass("fixed");e.html("N");t.text("a");n.text("w");r.text("l");i.text("b");s.text("c");setTimeout(function(){f.addClass("fixed-after-anim")},300)}else if(u<=100&&f.hasClass("fixed")||o<1025){a.removeClass("open");f.removeClass("fixed-after-anim").removeClass("fixed");e.html("Neil<br/>Carpenter");t.text("About");n.text("Work");r.text("Labs");i.text("Blog");s.html("Contact")}};$(window).bind("scroll",function(){scrollDisplayMenu()});$("#back-to-top").click(function(){$("body,html").animate({scrollTop:0},1e3,"easeInOutQuint");return!1});$(".double-hover").hover(function(){$(this).parent().find(".double-hover").addClass("mouseenter")},function(){$(this).parent().find(".double-hover").removeClass("mouseenter")});$("#expanded-footer").hide();$("#toggle-footer").click(function(e){e.preventDefault();var t=$(window).width(),n;t>768?n=$(document).height():n=$(document).height()-100;var r='<iframe allowtransparency="true" frameborder="0" scrolling="no" src="//platform.twitter.com/widgets/follow_button.html?screen_name=NeilCarpenter&show_count=false" style="width: 150px; height:20px;"></iframe>',i=$("#toggle-footer span");if($(this).hasClass("footer-open")){$(this).removeClass("footer-open");$(this).addClass("follow-button-loaded");$("#expanded-footer").slideUp(500,"easeInOutQuint")}else{$(this).addClass("footer-open");$("#expanded-footer").slideDown(500,"easeInOutQuint");$("html, body").animate({scrollTop:n},500,"easeInOutQuint");$(this).hasClass("follow-button-loaded")||$(".follow-button").html(r)}});$(".nav-control a").click(function(){$html=$("html");$html.hasClass("nav-open")?$html.removeClass("nav-open"):$html.addClass("nav-open");return!1})});(function(e){function t(e,t,n,r){if("addEventListener"in e)try{e.addEventListener(t,n,r)}catch(i){if(typeof n!="object"||!n.handleEvent)throw i;e.addEventListener(t,function(e){n.handleEvent.call(n,e)},r)}else"attachEvent"in e&&(typeof n=="object"&&n.handleEvent?e.attachEvent("on"+t,function(){n.handleEvent.call(n)}):e.attachEvent("on"+t,n))}function n(e,t,n,r){if("removeEventListener"in e)try{e.removeEventListener(t,n,r)}catch(i){if(typeof n!="object"||!n.handleEvent)throw i;e.removeEventListener(t,function(e){n.handleEvent.call(n,e)},r)}else"detachEvent"in e&&(typeof n=="object"&&n.handleEvent?e.detachEvent("on"+t,function(){n.handleEvent.call(n)}):e.detachEvent("on"+t,n))}window.MBP=window.MBP||{};MBP.fastButton=function(e,t){this.handler=t;if(e.length&&e.length>1)for(var n in e)this.addClickEvent(e[n]);else this.addClickEvent(e)};MBP.fastButton.prototype.handleEvent=function(e){e=e||window.event;switch(e.type){case"touchstart":this.onTouchStart(e);break;case"touchmove":this.onTouchMove(e);break;case"touchend":this.onClick(e);break;case"click":this.onClick(e)}};MBP.fastButton.prototype.onTouchStart=function(t){var n=t.srcElement;t.stopPropagation();n.addEventListener("touchend",this,!1);e.body.addEventListener("touchmove",this,!1);this.startX=t.touches[0].clientX;this.startY=t.touches[0].clientY;n.style.backgroundColor="rgba(0,0,0,.7)"};MBP.fastButton.prototype.onTouchMove=function(e){(Math.abs(e.touches[0].clientX-this.startX)>10||Math.abs(e.touches[0].clientY-this.startY)>10)&&this.reset(element)};MBP.fastButton.prototype.onClick=function(e){e=e||window.event;var t=e.srcElement;e.stopPropagation&&e.stopPropagation();this.reset(e);this.handler.apply(e.currentTarget,[e]);e.type=="touchend"&&MBP.preventGhostClick(this.startX,this.startY);t.style.backgroundColor=""};MBP.fastButton.prototype.reset=function(t){var r=t.srcElement;n(r,"touchend",this,!1);n(e.body,"touchmove",this,!1);r.style.backgroundColor=""};MBP.fastButton.prototype.addClickEvent=function(e){t(e,"touchstart",this,!1);t(e,"click",this,!1)};MBP.preventGhostClick=function(e,t){MBP.coords.push(e,t);window.setTimeout(function(){MBP.coords.splice(0,2)},2500)};MBP.ghostClickHandler=function(e){if(!MBP.hadTouchEvent&&"ontouchstart"in window){e.stopPropagation();e.preventDefault();return}for(var t=0,n=MBP.coords.length;t<n;t+=2){var r=MBP.coords[t],i=MBP.coords[t+1];if(Math.abs(e.clientX-r)<25&&Math.abs(e.clientY-i)<25){e.stopPropagation();e.preventDefault()}}};e.addEventListener&&e.addEventListener("click",MBP.ghostClickHandler,!0);t(e.documentElement,"touchstart",function(){MBP.hadTouchEvent=!0},!1);MBP.coords=[];MBP.enableActive=function(){e.addEventListener("touchstart",function(){},!1)}})(document);(function(e){function c(){n.setAttribute("content",s);o=!0}function h(){n.setAttribute("content",i);o=!1}function p(t){l=t.accelerationIncludingGravity;u=Math.abs(l.x);a=Math.abs(l.y);f=Math.abs(l.z);!e.orientation&&(u>7||(f>6&&a<8||f<8&&a>6)&&u>5)?o&&h():o||c()}if(!(/iPhone|iPad|iPod/.test(navigator.platform)&&navigator.userAgent.indexOf("AppleWebKit")>-1))return;var t=e.document;if(!t.querySelector)return;var n=t.querySelector("meta[name=viewport]"),r=n&&n.getAttribute("content"),i=r+",maximum-scale=1",s=r+",maximum-scale=10",o=!0,u,a,f,l;if(!n)return;e.addEventListener("orientationchange",c,!1);e.addEventListener("devicemotion",p,!1)})(this);(function(e){var t=e.document;if(!location.hash&&e.addEventListener){window.scrollTo(0,1);var n=1,r=function(){return e.pageYOffset||t.compatMode==="CSS1Compat"&&t.documentElement.scrollTop||t.body.scrollTop||0},i=setInterval(function(){if(t.body){clearInterval(i);n=r();e.scrollTo(0,n===1?0:1)}},15);e.addEventListener("load",function(){setTimeout(function(){r()<20&&e.scrollTo(0,n===1?0:1)},0)})}})(this);$(function(){function e(){var e=$(window).width();if(e>500){$(".slider").hide();$(".slider p").css("opacity",0);$(".slider-holder > a").removeClass("open");$(".scope .slider").show();$(".scope .slider p").css("opacity",1);$(".scope > a").addClass("open")}else{$(".slider").show();$(".slider p").css("opacity",1);$(".slider-holder > a").addClass("open")}}$("#not-so-skinny h3").each(function(){var e=$(this).text(),t=$("<a/>").attr("href","#").attr("title","Show/hide "+e);$(this).wrap(t)});e();$(".scope h3").append("<span>1</span>");$(".responsibilities h3").append("<span>2</span>");$(".technical h3").append("<span>3</span>");$(".outcome h3").append("<span>4</span>");$(".slider-holder > a").click(function(){var e=$(this),t=e.parent(),n=t.find(".slider"),r=n.find("p"),i=e.find("span");if(e.hasClass("open")){n.slideUp(350,"easeInQuad");r.animate({opacity:0},350,"easeInQuad");e.removeClass("open")}else{n.slideDown(350,"easeInQuad");r.animate({opacity:1},350,"easeInQuad");e.addClass("open")}return!1});$("#main-images a").addClass("slideshow");$(".smartphone-demo").click(function(e){e.preventDefault();var t=$(this),n=t.attr("href"),r=n.replace(/^http:\/\//,""),i=t.attr("title");$("html").addClass("demo-on");scrollDisplayMenu();$('<div id="demo-bg" class="loading"><div id="loading" class="demo"><span class="outer"><span class="inner"></span></span>&nbsp;Loading</div><a href="#" id="close-demo">Close</a></div>').hide().prependTo("body").fadeIn(500,"easeInQuint");$("<img />").attr("src","http://neilcarpenter.com/wp-content/themes/neil-v1/i/iphone-no-hand.png").load(function(){setTimeout(function(){var e='<div id="smartphone"><img src="http://neilcarpenter.com/wp-content/themes/neil-v1/i/iphone-no-hand.png" alt="iPhone" class="iphone-img" />';e+='<span class="screen-title">'+i+"</span>";e+='<span class="screen-url-bg"></span>';e+='<span class="screen-loading"></span>';e+='<span class="screen-url">'+r+"</span>";e+='<span class="screen-bg"></span></div>';var t='<iframe src="'+n+'" width="332" height="376"></iframe>';$("#demo-bg").removeClass("loading").append(e);$("#smartphone").append(t);$("#loading").fadeOut(500,function(){$(this).remove()});$("#smartphone").animate({top:"-=110%"},800,"easeInOutBack",function(){$("#smartphone").addClass("ready");setTimeout(function(){$("#smartphone").addClass("load-complete")},2100)})},1e3)});$("#close-demo").click(function(e){e.preventDefault();$("#demo-bg").addClass("demo-closing");setTimeout(function(){$("#smartphone").addClass("hide-iframe");$("#smartphone").animate({top:"+=110%"},800,"easeInOutBack");setTimeout(function(){$("#demo-bg").fadeOut(500,"easeInQuint",function(){$(this).remove()});$("html").removeClass("demo-on")},500)},300)})});$(".tablet-demo").click(function(e){e.preventDefault();var t=$(this),n=t.attr("href"),r=n.replace(/^http:\/\//,""),i=t.attr("title");$("html").addClass("demo-on");scrollDisplayMenu();$('<div id="demo-bg" class="loading"><div id="loading" class="demo"><span class="outer"><span class="inner"></span></span>&nbsp;Loading</div><a href="#" id="close-demo">Close</a></div>').hide().prependTo("body").fadeIn(500,"easeInQuint");$("<img />").attr("src","http://neilcarpenter.com/wp-content/themes/neil-v1/i/ipad-no-hand.png").load(function(){setTimeout(function(){var e='<div id="tablet"><img src="http://neilcarpenter.com/wp-content/themes/neil-v1/i/ipad-no-hand.png" alt="iPad" class="ipad-img" />';e+='<span class="screen-title">'+i+"</span>";e+='<span class="screen-url-bg"></span>';e+='<span class="screen-loading"></span>';e+='<span class="screen-url">'+r+"</span>";e+='<span class="screen-bg"></span></div>';var t='<iframe src="'+n+'" width="752" height="925"></iframe>';$("#demo-bg").removeClass("loading").append(e);$("#tablet").append(t);$("#loading").fadeOut(500,function(){$(this).remove()});$("#tablet").animate({top:"-=125%"},800,"easeInOutBack",function(){$("#tablet").addClass("ready");setTimeout(function(){$("#tablet").addClass("load-complete")},2100)})},1e3)});$("#close-demo").click(function(e){e.preventDefault();$("#demo-bg").addClass("demo-closing");setTimeout(function(){$("#tablet").addClass("hide-iframe");$("#tablet").animate({top:"+=125%"},800,"easeInOutBack");setTimeout(function(){$("#demo-bg").fadeOut(500,"easeInQuint",function(){$(this).remove()});$("html").removeClass("demo-on")},500)},300)})});var t=$(".project-nav-holder").html(),n='<h1 class="current-project">'+$("#skinny").find("h1").text()+"</h1>";$("header").append(t);$("header").find(".project-nav a:first").after(n);var r=function(){var e=$("#container").width(),t=e-442;$("header").find(".project-nav").css("width",t)};r();$(window).on("debouncedresize",function(){scrollDisplayMenu();setTimeout(function(){r()},1e3)});$(".sharers").click(function(){$(this).css("cursor","default");$(".sharers-image").fadeOut(300);(function(e,t){var n,r=e.getElementsByTagName(t)[0],i=function(i,s){if(e.getElementById(s))return;n=e.createElement(t);n.src=i;s&&(n.id=s);r.parentNode.insertBefore(n,r)};i("https://apis.google.com/js/plusone.js");i("//connect.facebook.net/en_US/all.js#xfbml=1&appId=307678452602794","facebook-jssdk");i("//platform.twitter.com/widgets.js","twitter-wjs")})(document,"script");setTimeout(function(){$(".sharers-buttons").animate({opacity:1},300)},600)})});$(window).load(function(){var e=function(){var e=$(window).width(),t=$("#top-content").outerHeight(),n=$("#top-content img").outerHeight(),r=(t-n-30)*.5;if(e>768){$("#top-content").css("height",t);$("#top-image img").css("margin-top",r).css("margin-bottom",r)}};e();$(window).on("debouncedresize",function(){widthTesterResized=$(window).width();if(widthTester!=widthTesterResized){$("#top-content").attr("style","");$("#top-image img").attr("style","");setTimeout(function(){e()},350);t();n();widthTester=widthTesterResized}});var t=function(){$("#content").css("min-height",$(window).height()-258)};t();$("#loading").fadeOut(500,function(){$(this).remove();$(".pattern").removeClass("pattern-closed");$(window).width()>768?setTimeout(function(){$("#content").removeClass("loading")},550):$("#content").removeClass("loading")});var n=function(){function e(){return window.devicePixelRatio===undefined?1:window.devicePixelRatio}var t=$(window).width();$(".RWD-i").each(function(){$this=$(this);t<481&&e()===1?responsiveSrc=$this.attr("data-smallsrc"):t<481&&e()>1||t>480&&t<769&&e()===1?responsiveSrc=$this.attr("data-mediumsrc"):t>768&&e()===1&&(responsiveSrc=$this.attr("data-largesrc"));$this.attr("src",responsiveSrc)})};n()});(function(e,t){document.addEventListener("DOMContentLoaded",function(){var n={},r=t.attach(e.document.querySelectorAll(".slideshow"),n)},!1)})(window,window.Code.PhotoSwipe);